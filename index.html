<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2575.4">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; min-height: 14.0px}
  </style>
</head>
<body>
<p class="p1">&lt;!DOCTYPE html&gt;</p>
<p class="p1">&lt;html lang="nl"&gt;</p>
<p class="p1">&lt;head&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;meta charset="UTF-8"&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;title&gt;Regenboog Dash: De Kristalzoektocht&lt;/title&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&amp;display=swap" rel="stylesheet"&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;style&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>body {</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin: 0;</p>
<p class="p1"><span class="Apple-converted-space">            </span>overflow: hidden;</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-family: 'Inter', sans-serif;</p>
<p class="p1"><span class="Apple-converted-space">            </span>background-color: #1a1a2e; /* Donkere achtergrondkleur */</p>
<p class="p1"><span class="Apple-converted-space">            </span>display: flex;</p>
<p class="p1"><span class="Apple-converted-space">            </span>flex-direction: column;</p>
<p class="p1"><span class="Apple-converted-space">            </span>justify-content: center;</p>
<p class="p1"><span class="Apple-converted-space">            </span>align-items: center;</p>
<p class="p1"><span class="Apple-converted-space">            </span>min-height: 100vh;</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: #e0e0e0;</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 20px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>box-sizing: border-box;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>#game-container {</p>
<p class="p1"><span class="Apple-converted-space">            </span>background-color: #2a2a4a;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 15px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>box-shadow: 0 0 25px rgba(0, 255, 255, 0.5), 0 0 50px rgba(128, 0, 128, 0.5);</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 30px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>max-width: 800px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>width: 95%;</p>
<p class="p1"><span class="Apple-converted-space">            </span>text-align: center;</p>
<p class="p1"><span class="Apple-converted-space">            </span>display: flex;</p>
<p class="p1"><span class="Apple-converted-space">            </span>flex-direction: column;</p>
<p class="p1"><span class="Apple-converted-space">            </span>gap: 20px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>overflow-y: auto; /* Scrollen mogelijk maken voor lange teksten */</p>
<p class="p1"><span class="Apple-converted-space">            </span>max-height: 95vh; /* Beperk de hoogte voor scrollen */</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>h1 {</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-size: 2.8em;</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: #ff69b4;</p>
<p class="p1"><span class="Apple-converted-space">            </span>text-shadow: 0 0 10px #ff69b4;</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin-bottom: 20px;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>#story-text {</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-size: 1.2em;</p>
<p class="p1"><span class="Apple-converted-space">            </span>line-height: 1.6;</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin-bottom: 30px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: #c0c0d0;</p>
<p class="p1"><span class="Apple-converted-space">            </span>min-height: 150px; /* Zorgt voor consistente hoogte */</p>
<p class="p1"><span class="Apple-converted-space">            </span>display: flex;</p>
<p class="p1"><span class="Apple-converted-space">            </span>align-items: center;</p>
<p class="p1"><span class="Apple-converted-space">            </span>justify-content: center;</p>
<p class="p1"><span class="Apple-converted-space">            </span>text-align: left;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>#choices {</p>
<p class="p1"><span class="Apple-converted-space">            </span>display: flex;</p>
<p class="p1"><span class="Apple-converted-space">            </span>flex-direction: column;</p>
<p class="p1"><span class="Apple-converted-space">            </span>gap: 15px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>width: 100%;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.choice-button {</p>
<p class="p1"><span class="Apple-converted-space">            </span>background-color: #8a2be2;</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: white;</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 15px 25px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border: none;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 25px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-size: 1.1em;</p>
<p class="p1"><span class="Apple-converted-space">            </span>cursor: pointer;</p>
<p class="p1"><span class="Apple-converted-space">            </span>transition: background-color 0.3s, transform 0.2s, box-shadow 0.3s;</p>
<p class="p1"><span class="Apple-converted-space">            </span>box-shadow: 0 5px 10px rgba(138, 43, 226, 0.3);</p>
<p class="p1"><span class="Apple-converted-space">            </span>text-align: center;</p>
<p class="p1"><span class="Apple-converted-space">            </span>text-decoration: none; /* Voor a-tag styling */</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.choice-button:hover {</p>
<p class="p1"><span class="Apple-converted-space">            </span>background-color: #9932cc;</p>
<p class="p1"><span class="Apple-converted-space">            </span>transform: translateY(-2px);</p>
<p class="p1"><span class="Apple-converted-space">            </span>box-shadow: 0 7px 12px rgba(138, 43, 226, 0.5);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.choice-button:active {</p>
<p class="p1"><span class="Apple-converted-space">            </span>transform: translateY(0);</p>
<p class="p1"><span class="Apple-converted-space">            </span>box-shadow: 0 3px 8px rgba(138, 43, 226, 0.2);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>#stats {</p>
<p class="p1"><span class="Apple-converted-space">            </span>background-color: rgba(0, 0, 0, 0.4);</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 15px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 10px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>display: flex;</p>
<p class="p1"><span class="Apple-converted-space">            </span>justify-content: space-around;</p>
<p class="p1"><span class="Apple-converted-space">            </span>flex-wrap: wrap; /* Zorgt ervoor dat stats op nieuwe regel komen op kleine schermen */</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-size: 1.1em;</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: #00ffff;</p>
<p class="p1"><span class="Apple-converted-space">            </span>text-shadow: 0 0 5px #00ffff;</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin-top: 20px;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>#stats div {</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin: 5px 10px; /* Ruimte tussen stats */</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>#start-screen, #end-screen, #high-score-screen, #character-selection-rpg-screen {</p>
<p class="p1"><span class="Apple-converted-space">            </span>position: absolute;</p>
<p class="p1"><span class="Apple-converted-space">            </span>top: 0;</p>
<p class="p1"><span class="Apple-converted-space">            </span>left: 0;</p>
<p class="p1"><span class="Apple-converted-space">            </span>width: 100%;</p>
<p class="p1"><span class="Apple-converted-space">            </span>height: 100%;</p>
<p class="p1"><span class="Apple-converted-space">            </span>background-color: rgba(0, 0, 0, 0.9);</p>
<p class="p1"><span class="Apple-converted-space">            </span>display: flex;</p>
<p class="p1"><span class="Apple-converted-space">            </span>flex-direction: column;</p>
<p class="p1"><span class="Apple-converted-space">            </span>justify-content: center;</p>
<p class="p1"><span class="Apple-converted-space">            </span>align-items: center;</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: #e0e0e0;</p>
<p class="p1"><span class="Apple-converted-space">            </span>text-align: center;</p>
<p class="p1"><span class="Apple-converted-space">            </span>z-index: 200;</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 20px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>box-sizing: border-box;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>#start-screen input {</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 10px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-size: 1.2em;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 5px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border: 1px solid #00ffff;</p>
<p class="p1"><span class="Apple-converted-space">            </span>background-color: #3a3a5a;</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: #e0e0e0;</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin-bottom: 20px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>text-align: center;</p>
<p class="p1"><span class="Apple-converted-space">            </span>max-width: 300px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>width: 80%;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>#start-screen #start-game-button { /* Prominenter maken */</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-size: 1.5em;</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 20px 40px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>box-shadow: 0 8px 20px rgba(138, 43, 226, 0.6);</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin-top: 40px;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>#start-screen #start-game-button:hover {</p>
<p class="p1"><span class="Apple-converted-space">            </span>transform: translateY(-5px);</p>
<p class="p1"><span class="Apple-converted-space">            </span>box-shadow: 0 12px 25px rgba(138, 43, 226, 0.8);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>/* Nieuwe stijl voor de 'Speel als dit Personage!' knop */</p>
<p class="p1"><span class="Apple-converted-space">        </span>#character-selection-rpg-screen #select-character-rpg-button {</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-size: 1.5em;</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 20px 40px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>box-shadow: 0 8px 20px rgba(138, 43, 226, 0.6);</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin-top: 40px;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>#character-selection-rpg-screen #select-character-rpg-button:hover {</p>
<p class="p1"><span class="Apple-converted-space">            </span>transform: translateY(-5px);</p>
<p class="p1"><span class="Apple-converted-space">            </span>box-shadow: 0 12px 25px rgba(138, 43, 226, 0.8);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.hidden {</p>
<p class="p1"><span class="Apple-converted-space">            </span>display: none !important;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.error-message {</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: #ff69b4;</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-size: 0.9em;</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin-top: -15px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin-bottom: 10px;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.high-score-list {</p>
<p class="p1"><span class="Apple-converted-space">            </span>list-style: none;</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 0;</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-size: 1.4em;</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin-top: 20px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>max-height: 400px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>overflow-y: auto;</p>
<p class="p1"><span class="Apple-converted-space">            </span>width: 80%;</p>
<p class="p1"><span class="Apple-converted-space">            </span>max-width: 500px; /* Iets breder voor tijd */</p>
<p class="p1"><span class="Apple-converted-space">            </span>background-color: rgba(0, 0, 0, 0.5);</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 10px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 15px;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.high-score-list li {</p>
<p class="p1"><span class="Apple-converted-space">            </span>display: flex;</p>
<p class="p1"><span class="Apple-converted-space">            </span>justify-content: space-between;</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 10px 0;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-bottom: 1px solid rgba(0, 255, 255, 0.2);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.high-score-list li:last-child {</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-bottom: none;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>.high-score-list .score-details {</p>
<p class="p1"><span class="Apple-converted-space">            </span>display: flex;</p>
<p class="p1"><span class="Apple-converted-space">            </span>gap: 15px;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.character-options {</p>
<p class="p1"><span class="Apple-converted-space">            </span>display: flex;</p>
<p class="p1"><span class="Apple-converted-space">            </span>flex-wrap: wrap;</p>
<p class="p1"><span class="Apple-converted-space">            </span>justify-content: center;</p>
<p class="p1"><span class="Apple-converted-space">            </span>gap: 15px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>max-height: 60vh; /* Scrollable if too many characters */</p>
<p class="p1"><span class="Apple-converted-space">            </span>overflow-y: auto;</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 10px;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.character-card {</p>
<p class="p1"><span class="Apple-converted-space">            </span>background-color: #3a3a5a;</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 15px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 10px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>cursor: pointer;</p>
<p class="p1"><span class="Apple-converted-space">            </span>transition: transform 0.2s, box-shadow 0.2s, border-color 0.2s;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border: 2px solid transparent;</p>
<p class="p1"><span class="Apple-converted-space">            </span>width: 120px; /* Fixed width for cards */</p>
<p class="p1"><span class="Apple-converted-space">            </span>text-align: center;</p>
<p class="p1"><span class="Apple-converted-space">            </span>display: flex;</p>
<p class="p1"><span class="Apple-converted-space">            </span>flex-direction: column;</p>
<p class="p1"><span class="Apple-converted-space">            </span>align-items: center;</p>
<p class="p1"><span class="Apple-converted-space">            </span>justify-content: center;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.character-card:hover {</p>
<p class="p1"><span class="Apple-converted-space">            </span>transform: translateY(-5px);</p>
<p class="p1"><span class="Apple-converted-space">            </span>box-shadow: 0 0 15px rgba(0, 255, 255, 0.7);</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-color: #00ffff;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.character-card.selected {</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-color: #ff69b4;</p>
<p class="p1"><span class="Apple-converted-space">            </span>box-shadow: 0 0 20px rgba(255, 105, 180, 0.9);</p>
<p class="p1"><span class="Apple-converted-space">            </span>transform: scale(1.05);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.character-card h3 {</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin: 10px 0 0;</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: #e0e0e0;</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-size: 1.1em;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>.character-card p {</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-size: 0.8em;</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin: 5px 0 0;</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: #b0b0c0;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>/* Responsive aanpassingen */</p>
<p class="p1"><span class="Apple-converted-space">        </span>@media (max-width: 600px) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>h1 {</p>
<p class="p1"><span class="Apple-converted-space">                </span>font-size: 2em;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">            </span>#story-text {</p>
<p class="p1"><span class="Apple-converted-space">                </span>font-size: 1em;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">            </span>.choice-button {</p>
<p class="p1"><span class="Apple-converted-space">                </span>font-size: 1em;</p>
<p class="p1"><span class="Apple-converted-space">                </span>padding: 12px 20px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">            </span>#stats {</p>
<p class="p1"><span class="Apple-converted-space">                </span>flex-direction: column;</p>
<p class="p1"><span class="Apple-converted-space">                </span>gap: 10px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">            </span>#start-screen #start-game-button {</p>
<p class="p1"><span class="Apple-converted-space">                </span>font-size: 1.2em;</p>
<p class="p1"><span class="Apple-converted-space">                </span>padding: 15px 30px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">            </span>.high-score-list {</p>
<p class="p1"><span class="Apple-converted-space">                </span>font-size: 1.1em;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">            </span>.high-score-list .score-details {</p>
<p class="p1"><span class="Apple-converted-space">                </span>flex-direction: column;</p>
<p class="p1"><span class="Apple-converted-space">                </span>gap: 5px;</p>
<p class="p1"><span class="Apple-converted-space">                </span>align-items: flex-end;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">            </span>.character-card {</p>
<p class="p1"><span class="Apple-converted-space">                </span>width: 100px; /* Smaller cards on small screens */</p>
<p class="p1"><span class="Apple-converted-space">                </span>padding: 10px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">            </span>.character-card h3 {</p>
<p class="p1"><span class="Apple-converted-space">                </span>font-size: 1em;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">            </span>#character-selection-rpg-screen #select-character-rpg-button {</p>
<p class="p1"><span class="Apple-converted-space">                </span>font-size: 1.2em;</p>
<p class="p1"><span class="Apple-converted-space">                </span>padding: 15px 30px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/style&gt;</p>
<p class="p1">&lt;/head&gt;</p>
<p class="p1">&lt;body&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div id="game-container"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;h1&gt;Regenboog Dash: De Kristalzoektocht&lt;/h1&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div id="story-text"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div id="choices"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div id="stats"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div&gt;Naam: &lt;span id="player-name"&gt;&lt;/span&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div&gt;Gezondheid: &lt;span id="player-health"&gt;100&lt;/span&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div&gt;Goud: &lt;span id="player-gold"&gt;0&lt;/span&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div&gt;Kristalscherven: &lt;span id="player-shards"&gt;0&lt;/span&gt;/3&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div&gt;Reputatie: &lt;span id="player-reputation"&gt;0&lt;/span&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;!-- Start Scherm --&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div id="start-screen"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;h2&gt;Welkom, Regenboogwachter!&lt;/h2&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;p&gt;In een wereld doordrenkt van magie en mysterie, staat het legendarische Regenboogkristal centraal. Het is de bron van balans en kleur, bewaakt door jullie, de **Regenboogwachters** – een hechte groep helden, beter bekend als **Rainbow Dash**!&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;p&gt;Maar duistere tijden zijn aangebroken. Het kristal is versplinterd in drie machtige scherven, verspreid over de meest gevaarlijke uithoeken van het land. Zonder het kristal dreigt de wereld haar kleuren te verliezen en te verzinken in chaos.&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;p&gt;Jouw missie, jonge wachter, is om samen met je vrienden de scherven te vinden en het kristal te herstellen. Elke keuze telt, elke vriend kan van pas komen. Je gezondheid, goud en reputatie zullen je gids zijn. En wie weet, misschien ontdek je wel verborgen krachten...&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;button id="start-game-button"&gt;Begin Avontuur&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;button id="show-highscores-button"&gt;High Scores&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;!-- Character Selection Screen --&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div id="character-selection-rpg-screen" class="hidden"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;h2&gt;Kies je Personage&lt;/h2&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div class="character-options" id="character-options-rpg"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;!-- Character cards will be dynamically inserted here --&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;button id="select-character-rpg-button" disabled&gt;Speel als dit Personage!&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;!-- Einde Scherm --&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div id="end-screen" class="hidden"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;h2&gt;Einde van het Avontuur&lt;/h2&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;p id="end-message"&gt;&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;button id="restart-game-button"&gt;Opnieuw Spelen&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;!-- High Score Screen --&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div id="high-score-screen" class="hidden"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;h2&gt;High Scores&lt;/h2&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;ul id="high-score-list" class="high-score-list"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;!-- Scores will be loaded here --&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/ul&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;button id="back-to-menu-from-highscores-button"&gt;Terug naar Menu&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;script type="module"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>// Firebase configuratie en initialisatie (verplicht, zelfs als niet gebruikt)</p>
<p class="p1"><span class="Apple-converted-space">        </span>const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';</p>
<p class="p1"><span class="Apple-converted-space">        </span>const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : {};</p>
<p class="p1"><span class="Apple-converted-space">        </span>const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";</p>
<p class="p1"><span class="Apple-converted-space">        </span>import { getAuth, signInAnonymously, signInWithCustomToken } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";</p>
<p class="p1"><span class="Apple-converted-space">        </span>import { getFirestore, collection, addDoc, getDocs, query, onSnapshot } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>let app, db, auth, userId;</p>
<p class="p1"><span class="Apple-converted-space">        </span>let isFirebaseReady = false; // Track Firebase readiness</p>
<p class="p1"><span class="Apple-converted-space">        </span>async function initFirebase() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>try {</p>
<p class="p1"><span class="Apple-converted-space">                </span>app = initializeApp(firebaseConfig);</p>
<p class="p1"><span class="Apple-converted-space">                </span>db = getFirestore(app);</p>
<p class="p1"><span class="Apple-converted-space">                </span>auth = getAuth(app);</p>
<p class="p1"><span class="Apple-converted-space">                </span>if (initialAuthToken) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>await signInWithCustomToken(auth, initialAuthToken);</p>
<p class="p1"><span class="Apple-converted-space">                </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>await signInAnonymously(auth);</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p1"><span class="Apple-converted-space">                </span>userId = auth.currentUser?.uid || crypto.randomUUID();</p>
<p class="p1"><span class="Apple-converted-space">                </span>console.log("Firebase geïnitialiseerd. Gebruikers-ID:", userId);</p>
<p class="p1"><span class="Apple-converted-space">                </span>isFirebaseReady = true;</p>
<p class="p1"><span class="Apple-converted-space">            </span>} catch (error) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>console.error("Fout bij initialiseren van Firebase of inloggen:", error);</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>initFirebase();</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>const storyTextElement = document.getElementById('story-text');</p>
<p class="p1"><span class="Apple-converted-space">        </span>const choicesElement = document.getElementById('choices');</p>
<p class="p1"><span class="Apple-converted-space">        </span>const playerNameDisplay = document.getElementById('player-name');</p>
<p class="p1"><span class="Apple-converted-space">        </span>const playerHealthDisplay = document.getElementById('player-health');</p>
<p class="p1"><span class="Apple-converted-space">        </span>const playerGoldDisplay = document.getElementById('player-gold');</p>
<p class="p1"><span class="Apple-converted-space">        </span>const playerShardsDisplay = document.getElementById('player-shards');</p>
<p class="p1"><span class="Apple-converted-space">        </span>const playerReputationDisplay = document.getElementById('player-reputation');</p>
<p class="p1"><span class="Apple-converted-space">        </span>const startScreen = document.getElementById('start-screen');</p>
<p class="p1"><span class="Apple-converted-space">        </span>const startGameButton = document.getElementById('start-game-button');</p>
<p class="p1"><span class="Apple-converted-space">        </span>const showHighscoresButton = document.getElementById('show-highscores-button');</p>
<p class="p1"><span class="Apple-converted-space">        </span>const endScreen = document.getElementById('end-screen');</p>
<p class="p1"><span class="Apple-converted-space">        </span>const endMessageElement = document.getElementById('end-message');</p>
<p class="p1"><span class="Apple-converted-space">        </span>const restartGameButton = document.getElementById('restart-game-button');</p>
<p class="p1"><span class="Apple-converted-space">        </span>const highScoreScreen = document.getElementById('high-score-screen');</p>
<p class="p1"><span class="Apple-converted-space">        </span>const highScoreList = document.getElementById('high-score-list');</p>
<p class="p1"><span class="Apple-converted-space">        </span>const backToMenuFromHighscoresButton = document.getElementById('back-to-menu-from-highscores-button');</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>const characterSelectionRpgScreen = document.getElementById('character-selection-rpg-screen');</p>
<p class="p1"><span class="Apple-converted-space">        </span>const characterOptionsRpg = document.getElementById('character-options-rpg');</p>
<p class="p1"><span class="Apple-converted-space">        </span>const selectCharacterRpgButton = document.getElementById('select-character-rpg-button');</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>let player = {</p>
<p class="p1"><span class="Apple-converted-space">            </span>name: "Avonturier",</p>
<p class="p1"><span class="Apple-converted-space">            </span>health: 100,</p>
<p class="p1"><span class="Apple-converted-space">            </span>gold: 0,</p>
<p class="p1"><span class="Apple-converted-space">            </span>crystalShards: 0,</p>
<p class="p1"><span class="Apple-converted-space">            </span>reputation: 0,</p>
<p class="p1"><span class="Apple-converted-space">            </span>inventory: [],</p>
<p class="p1"><span class="Apple-converted-space">            </span>friendsMet: [],</p>
<p class="p1"><span class="Apple-converted-space">            </span>chosenNpcRole: null, // Slaat de naam van de NPC op als de speler die rol op zich neemt</p>
<p class="p1"><span class="Apple-converted-space">            </span>startTime: 0,</p>
<p class="p1"><span class="Apple-converted-space">            </span>endTime: 0,</p>
<p class="p1"><span class="Apple-converted-space">            </span>duration: 0</p>
<p class="p1"><span class="Apple-converted-space">        </span>};</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Lijst van NPC namen en hun beschrijvingen voor de selectie</p>
<p class="p1"><span class="Apple-converted-space">        </span>const npcCharacters = [</p>
<p class="p1"><span class="Apple-converted-space">            </span>{ name: "Esmee", description: "De wijze strateeg, scherpzinnig en kalm." },</p>
<p class="p1"><span class="Apple-converted-space">            </span>{ name: "Jason", description: "De onverschrokken krijger, sterk en moedig." },</p>
<p class="p1"><span class="Apple-converted-space">            </span>{ name: "Robin", description: "De behendige sluipschutter, snel en stil." },</p>
<p class="p1"><span class="Apple-converted-space">            </span>{ name: "Kees", description: "De altijd optimistische, brengt licht en moed." },</p>
<p class="p1"><span class="Apple-converted-space">            </span>{ name: "Geoffrey", description: "De geleerde, vol kennis en wijsheid." },</p>
<p class="p1"><span class="Apple-converted-space">            </span>{ name: "Pleun", description: "De vrolijke uitvinder, creatief en energiek." },</p>
<p class="p1"><span class="Apple-converted-space">            </span>{ name: "Lisa", description: "De charmante diplomaat, overtuigend en vriendelijk." },</p>
<p class="p1"><span class="Apple-converted-space">            </span>{ name: "Renske", description: "De empathische genezer, zorgzaam en helend." },</p>
<p class="p1"><span class="Apple-converted-space">            </span>{ name: "Lars", description: "De tactische leider, georganiseerd en efficiënt." },</p>
<p class="p1"><span class="Apple-converted-space">            </span>{ name: "Anouk", description: "De nuchtere overlever, veerkrachtig en praktisch." },</p>
<p class="p1"><span class="Apple-converted-space">            </span>{ name: "Eleane", description: "De mysterieuze magiër, vol geheimen en spreuken." },</p>
<p class="p1"><span class="Apple-converted-space">            </span>{ name: "Elizabeth", description: "De kalme wachter, geduldig en observerend." },</p>
<p class="p1"><span class="Apple-converted-space">            </span>{ name: "Merijn", description: "De inventieve techneut, handig en vindingrijk." },</p>
<p class="p1"><span class="Apple-converted-space">            </span>{ name: "Nadine", description: "De inspirerende bard, brengt hoop en moed." }</p>
<p class="p1"><span class="Apple-converted-space">        </span>];</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>let selectedCharacterName = null; // Houdt de geselecteerde character naam bij</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Functie om de karakterkaarten te renderen</p>
<p class="p1"><span class="Apple-converted-space">        </span>function renderCharacterCards() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>characterOptionsRpg.innerHTML = '';</p>
<p class="p1"><span class="Apple-converted-space">            </span>npcCharacters.forEach(char =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                </span>const card = document.createElement('div');</p>
<p class="p1"><span class="Apple-converted-space">                </span>card.classList.add('character-card');</p>
<p class="p1"><span class="Apple-converted-space">                </span>card.dataset.characterName = char.name;</p>
<p class="p1"><span class="Apple-converted-space">                </span>card.innerHTML = `&lt;h3&gt;${char.name}&lt;/h3&gt;&lt;p&gt;${char.description}&lt;/p&gt;`;</p>
<p class="p1"><span class="Apple-converted-space">                </span>card.addEventListener('click', () =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>// Verwijder 'selected' van alle kaarten</p>
<p class="p1"><span class="Apple-converted-space">                    </span>document.querySelectorAll('.character-card').forEach(c =&gt; c.classList.remove('selected'));</p>
<p class="p1"><span class="Apple-converted-space">                    </span>// Voeg 'selected' toe aan de geklikte kaart</p>
<p class="p1"><span class="Apple-converted-space">                    </span>card.classList.add('selected');</p>
<p class="p1"><span class="Apple-converted-space">                    </span>selectedCharacterName = char.name;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>selectCharacterRpgButton.disabled = false;</p>
<p class="p1"><span class="Apple-converted-space">                </span>});</p>
<p class="p1"><span class="Apple-converted-space">                </span>characterOptionsRpg.appendChild(card);</p>
<p class="p1"><span class="Apple-converted-space">            </span>});</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Helper functie om de verhaaltekst aan te passen op basis van de gekozen NPC-rol</p>
<p class="p1"><span class="Apple-converted-space">        </span>function getAdjustedStoryText(originalText, stateKey) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>let text = originalText;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const chosenRole = player.chosenNpcRole;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>if (chosenRole) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>// Algemene vervangingen</p>
<p class="p1"><span class="Apple-converted-space">                </span>// Vervang de naam van de gekozen NPC door "jij" of "jouw" waar passend</p>
<p class="p1"><span class="Apple-converted-space">                </span>// Dit is een complexe taak die veel specifieke regels vereist.</p>
<p class="p1"><span class="Apple-converted-space">                </span>// Voor een robuuste oplossing zouden we een parser nodig hebben.</p>
<p class="p1"><span class="Apple-converted-space">                </span>// Hieronder een poging voor de meest voorkomende gevallen.</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>// Eerst de specifieke zinnen die een hele herschrijving behoeven</p>
<p class="p1"><span class="Apple-converted-space">                </span>if (chosenRole === "Robin") {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (stateKey === "woud_observatie") {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>text = `Je blijft stil en observeert. Jij, met je groene cape, springt behendig langs de wezens. Je knikt jezelf toe. 'Sluipen is de sleutel hier, ${player.name}.' Je reputatie stijgt.`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>} else if (stateKey === "dieper_woud_met_robin") {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>text = `Jij leidt de weg door een verborgen pad langs de kloof. 'Deze weg is veiliger,' zeg je. Ik heb gehoord dat Kees en Geoffrey in de buurt zijn, op zoek naar aanwijzingen.'`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>} else if (stateKey === "ontmoet_kees_geoffrey") {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>text = `Jij leidt je weg naar een open plek waar Kees, de altijd optimistische, en Geoffrey, de geleerde, bij een kampvuur zitten. 'Ah, ${player.name}!' roept Kees. 'We hebben een kaart gevonden die naar een verborgen tempel leidt waar een scherf zou zijn!' Geoffrey voegt toe: 'Maar er zijn vreemde energieën rondom de tempel.'`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>} else if (stateKey === "sluip_ijzige_reus") {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>text = `Met jouw expertise in sluipen, bewegen jullie geruisloos langs de slapende reus. Een spannende onderneming, maar het lukt! Je reputatie stijgt enorm. Je pakt de tweede scherf zonder gevecht.`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>}</p>
<p class="p1"><span class="Apple-converted-space">                </span>} else if (chosenRole === "Lars") {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (stateKey === "help_vrienden_ijzig") {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>text = `Samen met Anouk, de genezer, verslaan jullie de elementalen. Anouk, met haar rustgevende aura, geneest je voor 20 gezondheid. 'De tweede scherf is in de IJsgrot hierboven,' zeg jij. 'Maar de ingang is geblokkeerd door een magische barrière.'`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>} else if (stateKey === "zwakke_plek_ijs") {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>text = `Jij merkt een kleine, bijna onzichtbare scheur in het ijs op. Met een strategische slag van jouw wapen breekt de ingang open! Je reputatie stijgt door je observatievermogen.`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>} else if (stateKey === "grot_doorgang_ijzig") {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>text = `De doorgang leidt je naar een open, maar winderige plateau. In de verte zie je Anouk in gevecht met ijzige elementalen. 'Mooi op tijd, ${player.name}!' roep jij.`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>} else if (stateKey === "brug_ijzig") {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>text = `Net op tijd bereik je de overkant voordat de ijsbrug instort! Je ziet Anouk verderop, vechtend tegen ijzige elementalen. 'Daar ben je dan!' roept Anouk, terwijl ze een ijsscherf ontwijkt.`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>}</p>
<p class="p1"><span class="Apple-converted-space">                </span>} else if (chosenRole === "Anouk") {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (stateKey === "help_vrienden_ijzig") {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>text = `Samen met Lars, de strateeg, verslaan jullie de elementalen. Jij, met jouw rustgevende aura, geneest je voor 20 gezondheid. 'De tweede scherf is in de IJsgrot hierboven,' zegt Lars. 'Maar de ingang is geblokkeerd door een magische barrière.'`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>} else if (stateKey === "grot_doorgang_ijzig") {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>text = `De doorgang leidt je naar een open, maar winderige plateau. In de verte zie je Lars in gevecht met ijzige elementalen. 'Mooi op tijd, ${player.name}!' roept Lars.`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>} else if (stateKey === "brug_ijzig") {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>text = `Net op tijd bereik je de overkant voordat de ijsbrug instort! Je ziet Lars verderop, vechtend tegen ijzige elementalen. 'Daar ben je dan!' roep jij, terwijl je een ijsscherf ontwijkt.`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>}</p>
<p class="p1"><span class="Apple-converted-space">                </span>} else if (chosenRole === "Pleun") {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (stateKey === "volg_rook") {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>text = `De rook leidt je naar een actieve vulkaan. Jij en Merijn zijn bij de kraterrand, bezig met een vreemd, complex apparaat. Jullie zwaaien enthousiast. Je verliest 10 gezondheid door de intense hitte.`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>} else if (stateKey === "pleun_merijn_apparaat") {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>text = `Jij legt uit: 'Dit is een seismische stabilisator. Merijn heeft hem gebouwd om de vulkaan te kalmeren, zodat we veilig bij het drakenhol kunnen komen. De derde scherf is daar!' Merijn voegt toe: 'Het apparaat heeft alleen nog wat zeldzame mineralen nodig die diep in de vulkaan te vinden zijn.'`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>} else if (stateKey === "activeer_stabilisator") {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>text = `De seismische stabilisator wordt geactiveerd! De vulkaan kalmeert en de weg naar het drakenhol is veilig. Jullie gaan samen verder. 'Dat was kicken!' roep jij.`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>}</p>
<p class="p1"><span class="Apple-converted-space">                </span>} else if (chosenRole === "Merijn") {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (stateKey === "volg_rook") {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>text = `De rook leidt je naar een actieve vulkaan. Je ziet Pleun en jou bij de kraterrand, bezig met een vreemd, complex apparaat. Jullie zwaaien enthousiast. Je verliest 10 gezondheid door de intense hitte.`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>} else if (stateKey === "pleun_merijn_apparaat") {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>text = `Pleun legt uit: 'Dit is een seismische stabilisator. Jij hebt hem gebouwd om de vulkaan te kalmeren, zodat we veilig bij het drakenhol kunnen komen. De derde scherf is daar!' Jij voegt toe: 'Het apparaat heeft alleen nog wat zeldzame mineralen nodig die diep in de vulkaan te vinden zijn.'`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>}</p>
<p class="p1"><span class="Apple-converted-space">                </span>} else if (chosenRole === "Elizabeth") {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (stateKey === "zoek_derde_scherf") {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>text = `Twee scherven zijn binnen! Terug in het hoofdkwartier vertel jij, de kalme en verzamelde wachter, dat de laatste scherf in de Vuurlanden ligt, bewaakt door een oude vuurdraak. Pleun en Merijn zijn daar al op verkenning. Ze hebben een plan om de draak te omzeilen.`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>}</p>
<p class="p1"><span class="Apple-converted-space">                </span>} else if (chosenRole === "Esmee") {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (stateKey === "esmee_advies") {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>text = `Jij, de wijze strateeg van de Regenboogwachters, glimlacht. 'Welkom, ${player.name}. De eerste scherf wordt vermoed in het Fluisterende Woud, diep in het oosten. Wees voorzichtig, het woud is vol gevaren.' Je reputatie stijgt licht.`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>} else if (stateKey === "esmee_goud_advies") {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>text = `Jij fronst je wenkbrauwen. 'Goud is schaars nu. Maar ik heb gehoord dat de oude smid in Oakhaven nog wat klusjes heeft. Of misschien kun je wat spullen verkopen die je niet nodig hebt?'`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>} else if (stateKey === "zoek_tweede_scherf") {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>text = `Met de eerste scherf in handen keer je terug naar het hoofdkwartier. Jason wacht je op. 'Goed gedaan, ${player.name}!' zeg jij. 'De tweede scherf bevindt zich in de IJzige Pieken in het noorden. Lars en Anouk zijn daar al, ze zochten naar een geneeskrachtige plant.'`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>}</p>
<p class="p1"><span class="Apple-converted-space">                </span>} else if (chosenRole === "Jason") {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (stateKey === "jason_eerste_stap") {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>text = `Jij, de onverschrokken krijger, klopt jezelf op de schouder. 'Geen tijd te verliezen, ${player.name}! De eerste scherf is in het Fluisterende Woud. Ik heb gehoord dat Robin daar al is. Misschien kan hij helpen.'`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>} else if (stateKey === "jason_goud_advies") {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>text = `Jij lacht. 'Goud? Daar vecht je voor! Maar als je echt lui bent, kun je altijd in Oakhaven kijken. Of vraag Robin, die vindt altijd wel iets glimmends.'`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>} else if (stateKey === "zoek_tweede_scherf") {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>text = `Met de eerste scherf in handen keren jullie terug naar het hoofdkwartier. Esmee wacht je op. 'Goed gedaan, ${player.name}!' zegt Esmee. 'De tweede scherf bevindt zich in de IJzige Pieken in het noorden. Lars en Anouk zijn daar al, ze zochten naar een geneeskrachtige plant.'`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>}</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>// Vervang algemene verwijzingen naar de gekozen NPC</p>
<p class="p1"><span class="Apple-converted-space">                </span>const regex = new RegExp(chosenRole + "(?![a-z])", "gi"); // Zoek hele woorden</p>
<p class="p1"><span class="Apple-converted-space">                </span>text = text.replace(regex, "jij");</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>// Vervang bezittelijke voornaamwoorden (bijv. Robins expertise -&gt; jouw expertise)</p>
<p class="p1"><span class="Apple-converted-space">                </span>const regexPossessive = new RegExp(chosenRole + "s\\b", "gi");</p>
<p class="p1"><span class="Apple-converted-space">                </span>text = text.replace(regexPossessive, "jouw");</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>// Vervang 'hij/zij' door 'jij' of 'je' als de context het toelaat (dit is zeer complex en kan fout gaan)</p>
<p class="p1"><span class="Apple-converted-space">                </span>// Dit is een vereenvoudigde aanpak, perfecte grammatica is hier lastig zonder NLP</p>
<p class="p1"><span class="Apple-converted-space">                </span>text = text.replace(/\b(hij|zij)\b/gi, (match) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (text.includes(chosenRole) &amp;&amp; !text.includes("zegt hij") &amp;&amp; !text.includes("zegt zij")) { // Voorkom vervangen in dialogen</p>
<p class="p1"><span class="Apple-converted-space">                        </span>return "jij";</p>
<p class="p1"><span class="Apple-converted-space">                    </span>}</p>
<p class="p1"><span class="Apple-converted-space">                    </span>return match;</p>
<p class="p1"><span class="Apple-converted-space">                </span>});</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">            </span>return text;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// De speltoestanden (scenes)</p>
<p class="p1"><span class="Apple-converted-space">        </span>const gameStates = {</p>
<p class="p1"><span class="Apple-converted-space">            </span>intro: {</p>
<p class="p1"><span class="Apple-converted-space">                </span>text: (p) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>let introText = "Een ijzige stilte heeft zich over het Hoofdkwartier van de Regenboogwachters verspreid. De lucht trilt nog na van de catastrofale inslag die het Regenboogkristal versplinterde. Jullie, de legendarische groep Rainbow Dash, zijn de laatsten die de hoop levend kunnen houden.";</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (p.chosenNpcRole) {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>introText += ` Jij, ${p.chosenNpcRole}, staat naast je medewachters Esmee en Jason, klaar voor actie.`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>introText += " Esmee, de wijze strateeg, en Jason, de onverschrokken krijger, staan al klaar.";</p>
<p class="p1"><span class="Apple-converted-space">                    </span>}</p>
<p class="p1"><span class="Apple-converted-space">                    </span>introText += " Wat is je eerste zet?";</p>
<p class="p1"><span class="Apple-converted-space">                    </span>return getAdjustedStoryText(introText, 'intro');</p>
<p class="p1"><span class="Apple-converted-space">                </span>},</p>
<p class="p1"><span class="Apple-converted-space">                </span>choices: [</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Overleg met Esmee over de strategie.", nextState: "esmee_advies" },</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Vraag Jason naar de directe actie.", nextState: "jason_eerste_stap" },</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Controleer je uitrusting en bereid je voor.", nextState: "voorbereiding_start" }</p>
<p class="p1"><span class="Apple-converted-space">                </span>]</p>
<p class="p1"><span class="Apple-converted-space">            </span>},</p>
<p class="p1"><span class="Apple-converted-space">            </span>voorbereiding_start: {</p>
<p class="p1"><span class="Apple-converted-space">                </span>text: (p) =&gt; getAdjustedStoryText("Je controleert je riem: een lege buidel, een bot zwaard, en een lichte kleding. Niet bepaald de uitrusting van een held. Je beseft dat je goud nodig hebt. 'Een goede voorbereiding is het halve werk,' mompel je tegen jezelf. Wat nu?", 'voorbereiding_start'),</p>
<p class="p1"><span class="Apple-converted-space">                </span>choices: [</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Vraag Esmee om advies over goud.", nextState: "esmee_goud_advies" },</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Vraag Jason of hij nog iets nuttigs heeft.", nextState: "jason_goud_advies" }</p>
<p class="p1"><span class="Apple-converted-space">                </span>]</p>
<p class="p1"><span class="Apple-converted-space">            </span>},</p>
<p class="p1"><span class="Apple-converted-space">            </span>esmee_goud_advies: {</p>
<p class="p1"><span class="Apple-converted-space">                </span>text: (p) =&gt; getAdjustedStoryText("Esmee fronst haar wenkbrauwen. 'Goud is schaars nu. Maar ik heb gehoord dat de oude smid in Oakhaven nog wat klusjes heeft. Of misschien kun je wat spullen verkopen die je niet nodig hebt?'", 'esmee_goud_advies'),</p>
<p class="p1"><span class="Apple-converted-space">                </span>choices: [</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Reis naar Oakhaven.", nextState: "dorp_oakhaven" },</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Zoek nog eens goed rond in het hoofdkwartier.", nextState: "zoek_hoofdkwartier" }</p>
<p class="p1"><span class="Apple-converted-space">                </span>]</p>
<p class="p1"><span class="Apple-converted-space">            </span>},</p>
<p class="p1"><span class="Apple-converted-space">            </span>jason_goud_advies: {</p>
<p class="p1"><span class="Apple-converted-space">                </span>text: (p) =&gt; getAdjustedStoryText("Jason lacht. 'Goud? Daar vecht je voor! Maar als je echt lui bent, kun je altijd in Oakhaven kijken. Of vraag Robin, die vindt altijd wel iets glimmends.'", 'jason_goud_advies'),</p>
<p class="p1"><span class="Apple-converted-space">                </span>choices: [</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Reis naar Oakhaven.", nextState: "dorp_oakhaven" },</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Zoek nog eens goed rond in het hoofdkwartier.", nextState: "zoek_hoofdkwartier" }</p>
<p class="p1"><span class="Apple-converted-space">                </span>]</p>
<p class="p1"><span class="Apple-converted-space">            </span>},</p>
<p class="p1"><span class="Apple-converted-space">            </span>zoek_hoofdkwartier: {</p>
<p class="p1"><span class="Apple-converted-space">                </span>text: (p) =&gt; getAdjustedStoryText("Je snuffelt rond in stoffige hoekjes van het hoofdkwartier. Onder een omgevallen boekenkast vind je een vergeten zakje met 20 goud! Je reputatie stijgt licht, want opruimen is ook een heldendaad.", 'zoek_hoofdkwartier'),</p>
<p class="p1"><span class="Apple-converted-space">                </span>effect: () =&gt; { player.gold += 20; player.reputation += 2; },</p>
<p class="p1"><span class="Apple-converted-space">                </span>choices: [</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Nu je wat goud hebt, wat is de volgende stap?", nextState: "intro" }</p>
<p class="p1"><span class="Apple-converted-space">                </span>]</p>
<p class="p1"><span class="Apple-converted-space">            </span>},</p>
<p class="p1"><span class="Apple-converted-space">            </span>dorp_oakhaven: {</p>
<p class="p1"><span class="Apple-converted-space">                </span>text: (p) =&gt; getAdjustedStoryText("Je komt aan in het slaperige dorpje Oakhaven. De geur van versgebakken brood hangt in de lucht. Je ziet een herberg, een smederij en een markt. Waar ga je heen?", 'dorp_oakhaven'),</p>
<p class="p1"><span class="Apple-converted-space">                </span>choices: [</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Naar de smederij voor klusjes.", nextState: "smederij" },</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Naar de markt om te handelen.", nextState: "markt" },</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "De herberg in voor informatie.", nextState: "herberg_oakhaven" }</p>
<p class="p1"><span class="Apple-converted-space">                </span>]</p>
<p class="p1"><span class="Apple-converted-space">            </span>},</p>
<p class="p1"><span class="Apple-converted-space">            </span>smederij: {</p>
<p class="p1"><span class="Apple-converted-space">                </span>text: (p) =&gt; getAdjustedStoryText("De smid, een norse maar eerlijke man, heeft een klusje: help hem met het sorteren van ijzererts. Het is zwaar werk, maar je verdient 25 goud. Je reputatie stijgt.", 'smederij'),</p>
<p class="p1"><span class="Apple-converted-space">                </span>effect: () =&gt; { player.gold += 25; player.reputation += 5; },</p>
<p class="p1"><span class="Apple-converted-space">                </span>choices: [</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Terug naar het dorp.", nextState: "dorp_oakhaven" }</p>
<p class="p1"><span class="Apple-converted-space">                </span>]</p>
<p class="p1"><span class="Apple-converted-space">            </span>},</p>
<p class="p1"><span class="Apple-converted-space">            </span>markt: {</p>
<p class="p1"><span class="Apple-converted-space">                </span>text: (p) =&gt; getAdjustedStoryText("Op de markt zie je een handelaar die vreemde snuisterijen verkoopt. Je kunt proberen te handelen. Wat doe je?", 'markt'),</p>
<p class="p1"><span class="Apple-converted-space">                </span>choices: [</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Probeer een zeldzaam voorwerp te kopen (kost 15 goud).", nextState: "markt_koop" },</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Probeer een nutteloos voorwerp te verkopen (verdien 5 goud).", nextState: "markt_verkoop" }</p>
<p class="p1"><span class="Apple-converted-space">                </span>]</p>
<p class="p1"><span class="Apple-converted-space">            </span>},</p>
<p class="p1"><span class="Apple-converted-space">            </span>markt_koop: {</p>
<p class="p1"><span class="Apple-converted-space">                </span>text: (p) =&gt; getAdjustedStoryText("Je koopt een glimmende steen voor 15 goud. De handelaar lacht. 'Mogen de sterren je leiden!' Je hebt de 'Glimmende Steen' verkregen. Je weet nog niet waarvoor het is.", 'markt_koop'),</p>
<p class="p1"><span class="Apple-converted-space">                </span>effect: () =&gt; { player.gold -= 15; player.inventory.push("Glimmende Steen"); },</p>
<p class="p1"><span class="Apple-converted-space">                </span>choices: [</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Terug naar het dorp.", nextState: "dorp_oakhaven" }</p>
<p class="p1"><span class="Apple-converted-space">                </span>]</p>
<p class="p1"><span class="Apple-converted-space">            </span>},</p>
<p class="p1"><span class="Apple-converted-space">            </span>markt_verkoop: {</p>
<p class="p1"><span class="Apple-converted-space">                </span>text: (p) =&gt; getAdjustedStoryText("Je verkoopt een oud, roestig stuk metaal dat je in je zak vond voor 5 goud. De handelaar haalt zijn schouders op. 'Eén gek staat op, de ander gaat zitten.'", 'markt_verkoop'),</p>
<p class="p1"><span class="Apple-converted-space">                </span>effect: () =&gt; { player.gold += 5; },</p>
<p class="p1"><span class="Apple-converted-space">                </span>choices: [</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Terug naar het dorp.", nextState: "dorp_oakhaven" }</p>
<p class="p1"><span class="Apple-converted-space">                </span>]</p>
<p class="p1"><span class="Apple-converted-space">            </span>},</p>
<p class="p1"><span class="Apple-converted-space">            </span>herberg_oakhaven: {</p>
<p class="p1"><span class="Apple-converted-space">                </span>text: (p) =&gt; getAdjustedStoryText("De herberg is warm en gezellig. Je ziet een oude, wijze man aan een tafel zitten, en een groepje handelaren bij de bar. Wat doe je?", 'herberg_oakhaven'),</p>
<p class="p1"><span class="Apple-converted-space">                </span>choices: [</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Vraag de oude man naar het kristal.", nextState: "vraag_man_oakhaven" },</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Koop een drankje en luister de handelaren af (kost 5 goud).", nextState: "luister_af_handelaren" }</p>
<p class="p1"><span class="Apple-converted-space">                </span>]</p>
<p class="p1"><span class="Apple-converted-space">            </span>},</p>
<p class="p1"><span class="Apple-converted-space">            </span>vraag_man_oakhaven: {</p>
<p class="p1"><span class="Apple-converted-space">                </span>text: (p) =&gt; getAdjustedStoryText("De oude man kijkt je doordringend aan. 'Het Regenboogkristal is versplinterd... een tragedie. De eerste scherf wordt bewaakt door de Schaduw van het Woud, diep in het Fluisterende Woud. Zoek de Fluisterende Waterval.'", 'vraag_man_oakhaven'),</p>
<p class="p1"><span class="Apple-converted-space">                </span>choices: [</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Bedank de man en ga naar het woud.", nextState: "woud_ingang" }</p>
<p class="p1"><span class="Apple-converted-space">                </span>]</p>
<p class="p1"><span class="Apple-converted-space">            </span>},</p>
<p class="p1"><span class="Apple-converted-space">            </span>luister_af_handelaren: {</p>
<p class="p1"><span class="Apple-converted-space">                </span>text: (p) =&gt; getAdjustedStoryText("Je koopt een drankje en luistert af. De handelaren praten over een geheime grot achter de Fluisterende Waterval en een zwakke plek van de Schaduw van het Woud: puur licht. Je verliest 5 goud.", 'luister_af_handelaren'),</p>
<p class="p1"><span class="Apple-converted-space">                </span>effect: () =&gt; { player.gold -= 5; player.learnedAboutLight = true; },</p>
<p class="p1"><span class="Apple-converted-space">                </span>choices: [</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Ga naar het Fluisterende Woud.", nextState: "woud_ingang" }</p>
<p class="p1"><span class="Apple-converted-space">                </span>]</p>
<p class="p1"><span class="Apple-converted-space">            </span>},</p>
<p class="p1"><span class="Apple-converted-space">            </span>esmee_advies: {</p>
<p class="p1"><span class="Apple-converted-space">                </span>text: (p) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>let text = `Esmee, de wijze strateeg van de Regenboogwachters, glimlacht. 'Welkom, ${p.name}. De eerste scherf wordt vermoed in het Fluisterende Woud, diep in het oosten. Wees voorzichtig, het woud is vol gevaren.' Je reputatie stijgt licht.`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (p.chosenNpcRole === "Esmee") {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>text = `Jij, de wijze strateeg van de Regenboogwachters, glimlacht. 'Welkom, ${p.name}. De eerste scherf wordt vermoed in het Fluisterende Woud, diep in het oosten. Wees voorzichtig, het woud is vol gevaren.' Je reputatie stijgt licht.`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>}</p>
<p class="p1"><span class="Apple-converted-space">                    </span>return getAdjustedStoryText(text, 'esmee_advies');</p>
<p class="p1"><span class="Apple-converted-space">                </span>},</p>
<p class="p1"><span class="Apple-converted-space">                </span>effect: () =&gt; { player.reputation += 5; },</p>
<p class="p1"><span class="Apple-converted-space">                </span>choices: [</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Ga naar het Fluisterende Woud.", nextState: "woud_ingang" },</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Vraag Jason ook om advies.", nextState: "jason_eerste_stap" }</p>
<p class="p1"><span class="Apple-converted-space">                </span>]</p>
<p class="p1"><span class="Apple-converted-space">            </span>},</p>
<p class="p1"><span class="Apple-converted-space">            </span>jason_eerste_stap: {</p>
<p class="p1"><span class="Apple-converted-space">                </span>text: (p) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>let text = `Jason, de onverschrokken krijger, klopt je op de schouder. 'Geen tijd te verliezen, ${p.name}! De eerste scherf is in het Fluisterende Woud. Ik heb gehoord dat Robin daar al is. Misschien kan hij helpen.'`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (p.chosenNpcRole === "Jason") {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>text = `Jij, de onverschrokken krijger, klopt jezelf op de schouder. 'Geen tijd te verliezen, ${p.name}! De eerste scherf is in het Fluisterende Woud. Ik heb gehoord dat Robin daar al is. Misschien kan hij helpen.'`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>}</p>
<p class="p1"><span class="Apple-converted-space">                    </span>return getAdjustedStoryText(text, 'jason_eerste_stap');</p>
<p class="p1"><span class="Apple-converted-space">                </span>},</p>
<p class="p1"><span class="Apple-converted-space">                </span>choices: [</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Ga naar het Fluisterende Woud.", nextState: "woud_ingang" },</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Vraag Esmee om meer details.", nextState: "esmee_advies" }</p>
<p class="p1"><span class="Apple-converted-space">                </span>]</p>
<p class="p1"><span class="Apple-converted-space">            </span>},</p>
<p class="p1"><span class="Apple-converted-space">            </span>woud_ingang: {</p>
<p class="p1"><span class="Apple-converted-space">                </span>text: (p) =&gt; getAdjustedStoryText("Je betreedt het Fluisterende Woud. De bomen zijn oud en dicht, en het pad is nauwelijks zichtbaar. Je hoort geritsel in de struiken. Wat doe je?", 'woud_ingang'),</p>
<p class="p1"><span class="Apple-converted-space">                </span>choices: [</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Trek je wapen en bereid je voor.", nextState: "woud_gevaar" },</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Probeer stilletjes te observeren.", nextState: "woud_observatie" }</p>
<p class="p1"><span class="Apple-converted-space">                </span>]</p>
<p class="p1"><span class="Apple-converted-space">            </span>},</p>
<p class="p1"><span class="Apple-converted-space">            </span>woud_gevaar: {</p>
<p class="p1"><span class="Apple-converted-space">                </span>text: (p) =&gt; getAdjustedStoryText("Een groepje schaduwwezens springt uit de struiken! Het zijn kleine, maar venijnige wezens. Je vecht dapper, maar verliest 15 gezondheid. Je vindt wel 10 goud.", 'woud_gevaar'),</p>
<p class="p1"><span class="Apple-converted-space">                </span>effect: () =&gt; { player.health -= 15; player.gold += 10; },</p>
<p class="p1"><span class="Apple-converted-space">                </span>choices: [</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Vervolg je pad dieper het woud in.", nextState: "dieper_woud" }</p>
<p class="p1"><span class="Apple-converted-space">                </span>]</p>
<p class="p1"><span class="Apple-converted-space">            </span>},</p>
<p class="p1"><span class="Apple-converted-space">            </span>woud_observatie: {</p>
<p class="p1"><span class="Apple-converted-space">                </span>text: (p) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>let text = `Je blijft stil en observeert. Een figuur met een groene cape springt behendig langs de wezens. Het is Robin! Hij knikt je toe. 'Sluipen is de sleutel hier, ${p.name}.' Je reputatie stijgt.`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (p.chosenNpcRole === "Robin") {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>text = `Je blijft stil en observeert. Jij, met je groene cape, springt behendig langs de wezens. Je knikt jezelf toe. 'Sluipen is de sleutel hier, ${p.name}.' Je reputatie stijgt.`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>}</p>
<p class="p1"><span class="Apple-converted-space">                    </span>return getAdjustedStoryText(text, 'woud_observatie');</p>
<p class="p1"><span class="Apple-converted-space">                </span>},</p>
<p class="p1"><span class="Apple-converted-space">                </span>effect: () =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>player.reputation += 10;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (player.chosenNpcRole !== "Robin" &amp;&amp; !player.friendsMet.includes("Robin")) { // Voeg alleen toe als speler niet Robin is</p>
<p class="p1"><span class="Apple-converted-space">                        </span>player.friendsMet.push("Robin");</p>
<p class="p1"><span class="Apple-converted-space">                    </span>}</p>
<p class="p1"><span class="Apple-converted-space">                </span>},</p>
<p class="p1"><span class="Apple-converted-space">                </span>choices: [</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Volg " + (player.chosenNpcRole === "Robin" ? "jezelf" : "Robin") + " dieper het woud in.", nextState: "dieper_woud_met_robin" }</p>
<p class="p1"><span class="Apple-converted-space">                </span>]</p>
<p class="p1"><span class="Apple-converted-space">            </span>},</p>
<p class="p1"><span class="Apple-converted-space">            </span>dieper_woud: {</p>
<p class="p1"><span class="Apple-converted-space">                </span>text: (p) =&gt; getAdjustedStoryText("Dieper in het woud kom je bij een oude, vervallen brug over een diepe kloof. Het ziet er gevaarlijk uit. Wat doe je?", 'dieper_woud'),</p>
<p class="p1"><span class="Apple-converted-space">                </span>choices: [</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Probeer de brug over te steken.", nextState: "brug_oversteken" },</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Zoek naar een andere route.", nextState: "andere_route" }</p>
<p class="p1"><span class="Apple-converted-space">                </span>]</p>
<p class="p1"><span class="Apple-converted-space">            </span>},</p>
<p class="p1"><span class="Apple-converted-space">            </span>dieper_woud_met_robin: {</p>
<p class="p1"><span class="Apple-converted-space">                </span>text: (p) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>let text = `Robin leidt je door een verborgen pad langs de kloof. 'Deze weg is veiliger,' zegt hij. 'Ik heb gehoord dat Kees en Geoffrey in de buurt zijn, op zoek naar aanwijzingen.'`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (p.chosenNpcRole === "Robin") {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>text = `Jij leidt de weg door een verborgen pad langs de kloof. 'Deze weg is veiliger,' zeg je. 'Ik heb gehoord dat Kees en Geoffrey in de buurt zijn, op zoek naar aanwijzingen.'`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>}</p>
<p class="p1"><span class="Apple-converted-space">                    </span>return getAdjustedStoryText(text, 'dieper_woud_met_robin');</p>
<p class="p1"><span class="Apple-converted-space">                </span>},</p>
<p class="p1"><span class="Apple-converted-space">                </span>choices: [</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Ga verder met " + (player.chosenNpcRole === "Robin" ? "jezelf" : "Robin") + ".", nextState: "ontmoet_kees_geoffrey" }</p>
<p class="p1"><span class="Apple-converted-space">                </span>]</p>
<p class="p1"><span class="Apple-converted-space">            </span>},</p>
<p class="p1"><span class="Apple-converted-space">            </span>brug_oversteken: {</p>
<p class="p1"><span class="Apple-converted-space">                </span>text: (p) =&gt; getAdjustedStoryText("Je stapt voorzichtig op de brug. Halverwege kraakt hij en stort in! Je valt, maar weet je net vast te grijpen. Je verliest 25 gezondheid en moet een omweg nemen.", 'brug_oversteken'),</p>
<p class="p1"><span class="Apple-converted-space">                </span>effect: () =&gt; { player.health -= 25; },</p>
<p class="p1"><span class="Apple-converted-space">                </span>choices: [</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Zoek een andere route.", nextState: "andere_route" }</p>
<p class="p1"><span class="Apple-converted-space">                </span>]</p>
<p class="p1"><span class="Apple-converted-space">            </span>},</p>
<p class="p1"><span class="Apple-converted-space">            </span>andere_route: {</p>
<p class="p1"><span class="Apple-converted-space">                </span>text: (p) =&gt; getAdjustedStoryText("Na lang zoeken vind je een smal, rotsachtig pad dat om de kloof heen leidt. Het is een zware klim, maar je bereikt de overkant. Je bent moe, maar ongedeerd.", 'andere_route'),</p>
<p class="p1"><span class="Apple-converted-space">                </span>choices: [</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Vervolg je weg naar de waterval.", nextState: "waterval" }</p>
<p class="p1"><span class="Apple-converted-space">                </span>]</p>
<p class="p1"><span class="Apple-converted-space">            </span>},</p>
<p class="p1"><span class="Apple-converted-space">            </span>ontmoet_kees_geoffrey: {</p>
<p class="p1"><span class="Apple-converted-space">                </span>text: (p) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>let text = `Robin leidt je naar een open plek waar Kees, de altijd optimistische, en Geoffrey, de geleerde, bij een kampvuur zitten. 'Ah, ${p.name}!' roept Kees. 'We hebben een kaart gevonden die naar een verborgen tempel leidt waar een scherf zou zijn!' Geoffrey voegt toe: 'Maar er zijn vreemde energieën rondom de tempel.'`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (p.chosenNpcRole === "Robin") {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>text = `Jij leidt je weg naar een open plek waar Kees, de altijd optimistische, en Geoffrey, de geleerde, bij een kampvuur zitten. 'Ah, ${p.name}!' roept Kees. 'We hebben een kaart gevonden die naar een verborgen tempel leidt waar een scherf zou zijn!' Geoffrey voegt toe: 'Maar er zijn vreemde energieën rondom de tempel.'`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>} else if (p.chosenNpcRole === "Kees") {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>text = `Robin leidt je naar een open plek waar jij, de altijd optimistische, en Geoffrey, de geleerde, bij een kampvuur zitten. 'Ah, ${p.name}!' roep je. 'We hebben een kaart gevonden die naar een verborgen tempel leidt waar een scherf zou zijn!' Geoffrey voegt toe: 'Maar er zijn vreemde energieën rondom de tempel.'`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>} else if (p.chosenNpcRole === "Geoffrey") {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>text = `Robin leidt je naar een open plek waar Kees, de altijd optimistische, en jij, de geleerde, bij een kampvuur zitten. 'Ah, ${p.name}!' roept Kees. 'We hebben een kaart gevonden die naar een verborgen tempel leidt waar een scherf zou zijn!' Jij voegt toe: 'Maar er zijn vreemde energieën rondom de tempel.'`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>}</p>
<p class="p1"><span class="Apple-converted-space">                    </span>return getAdjustedStoryText(text, 'ontmoet_kees_geoffrey');</p>
<p class="p1"><span class="Apple-converted-space">                </span>},</p>
<p class="p1"><span class="Apple-converted-space">                </span>effect: () =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (player.chosenNpcRole !== "Kees" &amp;&amp; !player.friendsMet.includes("Kees")) player.friendsMet.push("Kees");</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (player.chosenNpcRole !== "Geoffrey" &amp;&amp; !player.friendsMet.includes("Geoffrey")) player.friendsMet.push("Geoffrey");</p>
<p class="p1"><span class="Apple-converted-space">                </span>},</p>
<p class="p1"><span class="Apple-converted-space">                </span>choices: [</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Ga met hen naar de tempel.", nextState: "tempel_aankomst" },</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Vraag Geoffrey naar de energieën.", nextState: "geoffrey_energie" }</p>
<p class="p1"><span class="Apple-converted-space">                </span>]</p>
<p class="p1"><span class="Apple-converted-space">            </span>},</p>
<p class="p1"><span class="Apple-converted-space">            </span>geoffrey_energie: {</p>
<p class="p1"><span class="Apple-converted-space">                </span>text: (p) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>let text = `Geoffrey legt uit: 'De energieën duiden op een magische barrière. Alleen degenen met een zuiver hart en een sterke wil kunnen erdoorheen. Of... een speciaal voorwerp, zoals een 'Glimmende Steen'.' Hij kijkt je hoopvol aan.`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (p.chosenNpcRole === "Geoffrey") {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>text = `Jij legt uit: 'De energieën duiden op een magische barrière. Alleen degenen met een zuiver hart en een sterke wil kunnen erdoorheen. Of... een speciaal voorwerp, zoals een 'Glimmende Steen'.' Je kijkt hoopvol aan.`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>}</p>
<p class="p1"><span class="Apple-converted-space">                    </span>return getAdjustedStoryText(text, 'geoffrey_energie');</p>
<p class="p1"><span class="Apple-converted-space">                </span>},</p>
<p class="p1"><span class="Apple-converted-space">                </span>choices: [</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Ga met hen naar de tempel.", nextState: "tempel_aankomst" }</p>
<p class="p1"><span class="Apple-converted-space">                </span>]</p>
<p class="p1"><span class="Apple-converted-space">            </span>},</p>
<p class="p1"><span class="Apple-converted-space">            </span>tempel_aankomst: {</p>
<p class="p1"><span class="Apple-converted-space">                </span>text: (p) =&gt; getAdjustedStoryText("Jullie komen aan bij een oude, mystieke tempel. Een onzichtbare, trillende barrière blokkeert de ingang. Wat doe je?", 'tempel_aankomst'),</p>
<p class="p1"><span class="Apple-converted-space">                </span>choices: [</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Probeer erdoorheen te dwingen.", nextState: "forceer_barriere" },</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Zoek naar een manier om de barrière te deactiveren.", nextState: "deactiveer_barriere" }</p>
<p class="p1"><span class="Apple-converted-space">                </span>]</p>
<p class="p1"><span class="Apple-converted-space">            </span>},</p>
<p class="p1"><span class="Apple-converted-space">            </span>forceer_barriere: {</p>
<p class="p1"><span class="Apple-converted-space">                </span>text: (p) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>let text = `Je probeert met brute kracht door de barrière te breken. Een elektrische schok treft je! Je verliest 30 gezondheid. De barrière blijft intact. 'Dat was niet zo slim, ${p.name},' moppert Kees, maar met een glimlach.`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (p.chosenNpcRole === "Kees") {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>text = `Je probeert met brute kracht door de barrière te breken. Een elektrische schok treft je! Je verliest 30 gezondheid. De barrière blijft intact. 'Dat was niet zo slim, ${p.name},' mopper je, maar met een glimlach.`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>}</p>
<p class="p1"><span class="Apple-converted-space">                    </span>return getAdjustedStoryText(text, 'forceer_barriere');</p>
<p class="p1"><span class="Apple-converted-space">                </span>},</p>
<p class="p1"><span class="Apple-converted-space">                </span>effect: () =&gt; { player.health -= 30; },</p>
<p class="p1"><span class="Apple-converted-space">                </span>choices: [</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Zoek een andere manier.", nextState: "deactiveer_barriere" }</p>
<p class="p1"><span class="Apple-converted-space">                </span>]</p>
<p class="p1"><span class="Apple-converted-space">            </span>},</p>
<p class="p1"><span class="Apple-converted-space">            </span>deactiveer_barriere: {</p>
<p class="p1"><span class="Apple-converted-space">                </span>text: (p) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>let text = `Geoffrey herinnert zich een oud ritueel. Met de hulp van Robin en Kees vinden jullie drie pilaren rondom de tempel. Je activeert ze en de barrière verdwijnt! Je reputatie stijgt enorm. Als je de 'Glimmende Steen' hebt, voel je dat deze resoneert met de energie van de tempel en je reputatie nog meer stijgt.`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (p.chosenNpcRole === "Geoffrey") {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>text = `Jij herinnert je een oud ritueel. Met de hulp van Robin en Kees vinden jullie drie pilaren rondom de tempel. Je activeert ze en de barrière verdwijnt! Je reputatie stijgt enorm. Als je de 'Glimmende Steen' hebt, voel je dat deze resoneert met de energie van de tempel en je reputatie nog meer stijgt.`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>}</p>
<p class="p1"><span class="Apple-converted-space">                    </span>return getAdjustedStoryText(text, 'deactiveer_barriere');</p>
<p class="p1"><span class="Apple-converted-space">                </span>},</p>
<p class="p1"><span class="Apple-converted-space">                </span>effect: () =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>player.reputation += 20;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (player.inventory.includes("Glimmende Steen")) {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>player.reputation += 10; // Extra reputatie</p>
<p class="p1"><span class="Apple-converted-space">                    </span>}</p>
<p class="p1"><span class="Apple-converted-space">                </span>},</p>
<p class="p1"><span class="Apple-converted-space">                </span>choices: [</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Ga de tempel binnen.", nextState: "tempel_binnen" }</p>
<p class="p1"><span class="Apple-converted-space">                </span>]</p>
<p class="p1"><span class="Apple-converted-space">            </span>},</p>
<p class="p1"><span class="Apple-converted-space">            </span>tempel_binnen: {</p>
<p class="p1"><span class="Apple-converted-space">                </span>text: (p) =&gt; getAdjustedStoryText("Binnenin de tempel vinden jullie een altaar. Bovenop ligt de eerste scherf van het Regenboogkristal! Maar terwijl je het pakt, verschijnt een schaduwbewaker, groter en dreigender dan de wezens in het woud. Wat doe je?", 'tempel_binnen'),</p>
<p class="p1"><span class="Apple-converted-space">                </span>choices: [</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Vecht tegen de bewaker!", nextState: "tempel_bewaker_gevecht" }</p>
<p class="p1"><span class="Apple-converted-space">                </span>]</p>
<p class="p1"><span class="Apple-converted-space">            </span>},</p>
<p class="p1"><span class="Apple-converted-space">            </span>tempel_bewaker_gevecht: {</p>
<p class="p1"><span class="Apple-converted-space">                </span>text: (p) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>let friendsInFight = [];</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (p.chosenNpcRole !== "Jason" &amp;&amp; p.friendsMet.includes("Jason")) friendsInFight.push("Jason");</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (p.chosenNpcRole !== "Renske" &amp;&amp; p.friendsMet.includes("Renske")) friendsInFight.push("Renske");</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (p.chosenNpcRole !== "Robin" &amp;&amp; p.friendsMet.includes("Robin")) friendsInFight.push("Robin");</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (p.chosenNpcRole !== "Kees" &amp;&amp; p.friendsMet.includes("Kees")) friendsInFight.push("Kees");</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (p.chosenNpcRole !== "Geoffrey" &amp;&amp; p.friendsMet.includes("Geoffrey")) friendsInFight.push("Geoffrey");</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                    </span>let text = `De bewaker is sterk! Gelukkig zijn ${friendsInFight.join(' en ')} er om je te helpen! Jullie vechten samen. Je verliest 20 gezondheid, maar de bewaker is verslagen! Je bemachtigt de eerste kristalscherf.`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (friendsInFight.length === 0) {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>text = `De bewaker is sterk! Je vecht alleen, maar met al je moed versla je hem! Je verliest 20 gezondheid en bemachtigt de eerste kristalscherf.`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>}</p>
<p class="p1"><span class="Apple-converted-space">                    </span>return getAdjustedStoryText(text, 'tempel_bewaker_gevecht');</p>
<p class="p1"><span class="Apple-converted-space">                </span>},</p>
<p class="p1"><span class="Apple-converted-space">                </span>effect: () =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>player.health -= 20;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>player.crystalShards += 1;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>player.reputation += 15;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>// Voeg vrienden toe als ze nog niet zijn ontmoet EN niet de gekozen rol zijn</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (player.chosenNpcRole !== "Jason" &amp;&amp; !player.friendsMet.includes("Jason")) player.friendsMet.push("Jason");</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (player.chosenNpcRole !== "Renske" &amp;&amp; !player.friendsMet.includes("Renske")) player.friendsMet.push("Renske");</p>
<p class="p1"><span class="Apple-converted-space">                </span>},</p>
<p class="p1"><span class="Apple-converted-space">                </span>choices: [</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Nu de volgende scherf vinden!", nextState: "zoek_tweede_scherf" }</p>
<p class="p1"><span class="Apple-converted-space">                </span>]</p>
<p class="p1"><span class="Apple-converted-space">            </span>},</p>
<p class="p1"><span class="Apple-converted-space">            </span>zoek_tweede_scherf: {</p>
<p class="p1"><span class="Apple-converted-space">                </span>text: (p) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>let text = `Met de eerste scherf in handen keren jullie terug naar het hoofdkwartier. Esmee en Jason wachten jullie op. 'Goed gedaan, ${p.name}!' zegt Esmee. 'De tweede scherf bevindt zich in de IJzige Pieken in het noorden. Lars en Anouk zijn daar al, ze zochten naar een geneeskrachtige plant.'`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (p.chosenNpcRole === "Esmee") {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>text = `Met de eerste scherf in handen keer je terug naar het hoofdkwartier. Jason wacht je op. 'Goed gedaan, ${p.name}!' zeg jij. 'De tweede scherf bevindt zich in de IJzige Pieken in het noorden. Lars en Anouk zijn daar al, ze zochten naar een geneeskrachtige plant.'`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>} else if (p.chosenNpcRole === "Jason") {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>text = `Met de eerste scherf in handen keren jullie terug naar het hoofdkwartier. Esmee wacht je op. 'Goed gedaan, ${p.name}!' zegt Esmee. 'De tweede scherf bevindt zich in de IJzige Pieken in het noorden. Lars en Anouk zijn daar al, ze zochten naar een geneeskrachtige plant.'`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>}</p>
<p class="p1"><span class="Apple-converted-space">                    </span>return getAdjustedStoryText(text, 'zoek_tweede_scherf');</p>
<p class="p1"><span class="Apple-converted-space">                </span>},</p>
<p class="p1"><span class="Apple-converted-space">                </span>choices: [</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Reis naar de IJzige Pieken.", nextState: "ijzige_pieken_aankomst" }</p>
<p class="p1"><span class="Apple-converted-space">                </span>]</p>
<p class="p1"><span class="Apple-converted-space">            </span>},</p>
<p class="p1"><span class="Apple-converted-space">            </span>ijzige_pieken_aankomst: {</p>
<p class="p1"><span class="Apple-converted-space">                </span>text: (p) =&gt; getAdjustedStoryText("De wind snijdt door je kleding terwijl je de IJzige Pieken betreedt. Het pad is verraderlijk en ijzig. Je ziet voetsporen in de sneeuw die naar een gevaarlijk uitziende ijsbrug leiden. Wat doe je?", 'ijzige_pieken_aankomst'),</p>
<p class="p1"><span class="Apple-converted-space">                </span>choices: [</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Volg de voetsporen over de ijsbrug.", nextState: "volg_voetsporen_ijzig" },</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Zoek een veiliger pad om de ijsbrug heen.", nextState: "veiliger_pad_ijzig" }</p>
<p class="p1"><span class="Apple-converted-space">                </span>]</p>
<p class="p1"><span class="Apple-converted-space">            </span>},</p>
<p class="p1"><span class="Apple-converted-space">            </span>volg_voetsporen_ijzig: {</p>
<p class="p1"><span class="Apple-converted-space">                </span>text: (p) =&gt; getAdjustedStoryText("De voetsporen leiden je naar een smalle ijsbrug. Terwijl je oversteekt, begint de brug te kraken! Je moet snel zijn. Je verliest 10 gezondheid door de kou en de val.", 'volg_voetsporen_ijzig'),</p>
<p class="p1"><span class="Apple-converted-space">                </span>effect: () =&gt; { player.health -= 10; },</p>
<p class="p1"><span class="Apple-converted-space">                </span>choices: [</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Ren over de brug!", nextState: "brug_ijzig" }</p>
<p class="p1"><span class="Apple-converted-space">                </span>]</p>
<p class="p1"><span class="Apple-converted-space">            </span>},</p>
<p class="p1"><span class="Apple-converted-space">            </span>veiliger_pad_ijzig: {</p>
<p class="p1"><span class="Apple-converted-space">                </span>text: (p) =&gt; getAdjustedStoryText("Je zoekt een omweg en vindt een grot die beschutting biedt tegen de wind. Binnenin ontdek je een verborgen doorgang. Het kost meer tijd, maar je reputatie stijgt door je voorzichtigheid.", 'veiliger_pad_ijzig'),</p>
<p class="p1"><span class="Apple-converted-space">                </span>effect: () =&gt; { player.reputation += 10; },</p>
<p class="p1"><span class="Apple-converted-space">                </span>choices: [</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Ga de doorgang in.", nextState: "grot_doorgang_ijzig" }</p>
<p class="p1"><span class="Apple-converted-space">                </span>]</p>
<p class="p1"><span class="Apple-converted-space">            </span>},</p>
<p class="p1"><span class="Apple-converted-space">            </span>brug_ijzig: {</p>
<p class="p1"><span class="Apple-converted-space">                </span>text: (p) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>let text = `Net op tijd bereik je de overkant voordat de ijsbrug instort! Je ziet Lars en Anouk verderop, vechtend tegen ijzige elementalen. 'Daar ben je dan!' roept Anouk, terwijl ze een ijsscherf ontwijkt.`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (p.chosenNpcRole === "Lars") {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>text = `Net op tijd bereik je de overkant voordat de ijsbrug instort! Je ziet Anouk verderop, vechtend tegen ijzige elementalen. 'Daar ben je dan!' roept Anouk, terwijl ze een ijsscherf ontwijkt.`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>} else if (p.chosenNpcRole === "Anouk") {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>text = `Net op tijd bereik je de overkant voordat de ijsbrug instort! Je ziet Lars verderop, vechtend tegen ijzige elementalen. 'Daar ben je dan!' roep je, terwijl je een ijsscherf ontwijkt.`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>}</p>
<p class="p1"><span class="Apple-converted-space">                    </span>return getAdjustedStoryText(text, 'brug_ijzig');</p>
<p class="p1"><span class="Apple-converted-space">                </span>},</p>
<p class="p1"><span class="Apple-converted-space">                </span>effect: () =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (player.chosenNpcRole !== "Lars" &amp;&amp; !player.friendsMet.includes("Lars")) player.friendsMet.push("Lars");</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (player.chosenNpcRole !== "Anouk" &amp;&amp; !player.friendsMet.includes("Anouk")) player.friendsMet.push("Anouk");</p>
<p class="p1"><span class="Apple-converted-space">                </span>},</p>
<p class="p1"><span class="Apple-converted-space">                </span>choices: [</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Help Lars en Anouk.", nextState: "help_vrienden_ijzig" }</p>
<p class="p1"><span class="Apple-converted-space">                </span>]</p>
<p class="p1"><span class="Apple-converted-space">            </span>},</p>
<p class="p1"><span class="Apple-converted-space">            </span>grot_doorgang_ijzig: {</p>
<p class="p1"><span class="Apple-converted-space">                </span>text: (p) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>let text = `De doorgang leidt je naar een open, maar winderige plateau. In de verte zie je Lars en Anouk in gevecht met ijzige elementalen. 'Mooi op tijd, ${p.name}!' roept Lars.`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (p.chosenNpcRole === "Lars") {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>text = `De doorgang leidt je naar een open, maar winderige plateau. In de verte zie je Anouk in gevecht met ijzige elementalen. 'Mooi op tijd, ${p.name}!' roep jij.`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>} else if (p.chosenNpcRole === "Anouk") {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>text = `De doorgang leidt je naar een open, maar winderige plateau. In de verte zie je Lars in gevecht met ijzige elementalen. 'Mooi op tijd, ${p.name}!' roept Lars.`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>}</p>
<p class="p1"><span class="Apple-converted-space">                    </span>return getAdjustedStoryText(text, 'grot_doorgang_ijzig');</p>
<p class="p1"><span class="Apple-converted-space">                </span>},</p>
<p class="p1"><span class="Apple-converted-space">                </span>effect: () =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (player.chosenNpcRole !== "Lars" &amp;&amp; !player.friendsMet.includes("Lars")) player.friendsMet.push("Lars");</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (player.chosenNpcRole !== "Anouk" &amp;&amp; !player.friendsMet.includes("Anouk")) player.friendsMet.push("Anouk");</p>
<p class="p1"><span class="Apple-converted-space">                </span>},</p>
<p class="p1"><span class="Apple-converted-space">                </span>choices: [</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Help Lars en Anouk.", nextState: "help_vrienden_ijzig" }</p>
<p class="p1"><span class="Apple-converted-space">                </span>]</p>
<p class="p1"><span class="Apple-converted-space">            </span>},</p>
<p class="p1"><span class="Apple-converted-space">            </span>help_vrienden_ijzig: {</p>
<p class="p1"><span class="Apple-converted-space">                </span>text: (p) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>let text = `Samen met Lars, de strateeg, en Anouk, de genezer, verslaan jullie de elementalen. Anouk, met haar rustgevende aura, geneest je voor 20 gezondheid. 'De tweede scherf is in de IJsgrot hierboven,' zegt Lars. 'Maar de ingang is geblokkeerd door een magische barrière.'`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (p.chosenNpcRole === "Lars") {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>text = `Samen met Anouk, de genezer, verslaan jullie de elementalen. Anouk, met haar rustgevende aura, geneest je voor 20 gezondheid. 'De tweede scherf is in de IJsgrot hierboven,' zeg jij. 'Maar de ingang is geblokkeerd door een magische barrière.'`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>} else if (p.chosenNpcRole === "Anouk") {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>text = `Samen met Lars, de strateeg, verslaan jullie de elementalen. Jij, met jouw rustgevende aura, geneest je voor 20 gezondheid. 'De tweede scherf is in de IJsgrot hierboven,' zegt Lars. 'Maar de ingang is geblokkeerd door een magische barrière.'`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>}</p>
<p class="p1"><span class="Apple-converted-space">                    </span>return getAdjustedStoryText(text, 'help_vrienden_ijzig');</p>
<p class="p1"><span class="Apple-converted-space">                </span>},</p>
<p class="p1"><span class="Apple-converted-space">                </span>effect: () =&gt; { player.health = Math.min(100, player.health + 20); }, // Genees, max 100</p>
<p class="p1"><span class="Apple-converted-space">                </span>choices: [</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Zoek een manier om de grot te openen.", nextState: "ijsgrot_ingang" }</p>
<p class="p1"><span class="Apple-converted-space">                </span>]</p>
<p class="p1"><span class="Apple-converted-space">            </span>},</p>
<p class="p1"><span class="Apple-converted-space">            </span>ijsgrot_ingang: {</p>
<p class="p1"><span class="Apple-converted-space">                </span>text: (p) =&gt; getAdjustedStoryText("De ingang van de IJsgrot is bedekt met een dikke laag magisch ijs. Het straalt kou uit. Wat doe je?", 'ijsgrot_ingang'),</p>
<p class="p1"><span class="Apple-converted-space">                </span>choices: [</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Probeer het ijs te smelten met brute kracht of magie (als je die hebt).", nextState: "smelt_ijs" },</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Zoek naar een zwakke plek in het ijs of een alternatieve ingang.", nextState: "zwakke_plek_ijs" }</p>
<p class="p1"><span class="Apple-converted-space">                </span>]</p>
<p class="p1"><span class="Apple-converted-space">            </span>},</p>
<p class="p1"><span class="Apple-converted-space">            </span>smelt_ijs: {</p>
<p class="p1"><span class="Apple-converted-space">                </span>text: (p) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>let text = `Je probeert het ijs te smelten met je eigen energie. Het werkt, maar kost je 15 gezondheid. De grot is open! Lars knikt waarderend.`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (p.chosenNpcRole === "Lars") {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>text = `Jij probeert het ijs te smelten met je eigen energie. Het werkt, maar kost je 15 gezondheid. De grot is open! Anouk knikt waarderend.`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>}</p>
<p class="p1"><span class="Apple-converted-space">                    </span>return getAdjustedStoryText(text, 'smelt_ijs');</p>
<p class="p1"><span class="Apple-converted-space">                </span>},</p>
<p class="p1"><span class="Apple-converted-space">                </span>effect: () =&gt; { player.health -= 15; },</p>
<p class="p1"><span class="Apple-converted-space">                </span>choices: [</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Ga de IJsgrot in.", nextState: "ijsgrot_binnen" }</p>
<p class="p1"><span class="Apple-converted-space">                </span>]</p>
<p class="p1"><span class="Apple-converted-space">            </span>},</p>
<p class="p1"><span class="Apple-converted-space">            </span>zwakke_plek_ijs: {</p>
<p class="p1"><span class="Apple-converted-space">                </span>text: (p) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>let text = `Lars merkt een kleine, bijna onzichtbare scheur in het ijs op. Met een strategische slag van zijn wapen (of jouw wapen, als je geen Lars hebt) breekt de ingang open! Je reputatie stijgt door je observatievermogen.`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (p.chosenNpcRole === "Lars") {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>text = `Jij merkt een kleine, bijna onzichtbare scheur in het ijs op. Met een strategische slag van jouw wapen breekt de ingang open! Je reputatie stijgt door je observatievermogen.`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>}</p>
<p class="p1"><span class="Apple-converted-space">                    </span>return getAdjustedStoryText(text, 'zwakke_plek_ijs');</p>
<p class="p1"><span class="Apple-converted-space">                </span>},</p>
<p class="p1"><span class="Apple-converted-space">                </span>effect: () =&gt; { player.reputation += 10; },</p>
<p class="p1"><span class="Apple-converted-space">                </span>choices: [</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Ga de IJsgrot in.", nextState: "ijsgrot_binnen" }</p>
<p class="p1"><span class="Apple-converted-space">                </span>]</p>
<p class="p1"><span class="Apple-converted-space">            </span>},</p>
<p class="p1"><span class="Apple-converted-space">            </span>ijsgrot_binnen: {</p>
<p class="p1"><span class="Apple-converted-space">                </span>text: (p) =&gt; getAdjustedStoryText("Binnenin de IJsgrot is het bitterkoud. Adem condenseert in de lucht. In het midden zie je de tweede kristalscherf, bewaakt door een kolossale ijzige reus die langzaam ademt. Wat doe je?", 'ijsgrot_binnen'),</p>
<p class="p1"><span class="Apple-converted-space">                </span>choices: [</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Val de ijzige reus aan!", nextState: "ijzige_reus_gevecht" },</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Probeer langs de reus te sluipen (als je Robin hebt ontmoet).", nextState: "sluip_ijzige_reus" }</p>
<p class="p1"><span class="Apple-converted-space">                </span>]</p>
<p class="p1"><span class="Apple-converted-space">            </span>},</p>
<p class="p1"><span class="Apple-converted-space">            </span>sluip_ijzige_reus: {</p>
<p class="p1"><span class="Apple-converted-space">                </span>text: (p) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (p.friendsMet.includes("Robin") || p.chosenNpcRole === "Robin") {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>return getAdjustedStoryText(`Met ${p.chosenNpcRole === "Robin" ? "jouw" : "Robin's"} expertise in sluipen, bewegen jullie geruisloos langs de slapende reus. Een spannende onderneming, maar het lukt! Je reputatie stijgt enorm. Je pakt de tweede scherf zonder gevecht.`, 'sluip_ijzige_reus');</p>
<p class="p1"><span class="Apple-converted-space">                    </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>return getAdjustedStoryText(`Je probeert te sluipen, maar je bent niet zo behendig als Robin. De reus wordt wakker! Je verliest 10 gezondheid en moet vechten.`, 'sluip_ijzige_reus');</p>
<p class="p1"><span class="Apple-converted-space">                    </span>}</p>
<p class="p1"><span class="Apple-converted-space">                </span>},</p>
<p class="p1"><span class="Apple-converted-space">                </span>effect: () =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (player.friendsMet.includes("Robin") || player.chosenNpcRole === "Robin") {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>player.crystalShards += 1;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>player.reputation += 25;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>updateGame('zoek_derde_scherf'); // Direct naar volgende fase</p>
<p class="p1"><span class="Apple-converted-space">                    </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>player.health -= 10;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>updateGame('ijzige_reus_gevecht'); // Terug naar gevecht</p>
<p class="p1"><span class="Apple-converted-space">                    </span>}</p>
<p class="p1"><span class="Apple-converted-space">                </span>},</p>
<p class="p1"><span class="Apple-converted-space">                </span>choices: [</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Ga verder.", nextState: "continue_after_sluip_reus" }</p>
<p class="p1"><span class="Apple-converted-space">                </span>]</p>
<p class="p1"><span class="Apple-converted-space">            </span>},</p>
<p class="p1"><span class="Apple-converted-space">            </span>continue_after_sluip_reus: {</p>
<p class="p1"><span class="Apple-converted-space">                </span>text: (p) =&gt; getAdjustedStoryText("...", 'continue_after_sluip_reus'), // Placeholder, wordt overschreven door effect</p>
<p class="p1"><span class="Apple-converted-space">                </span>choices: [] // Placeholder</p>
<p class="p1"><span class="Apple-converted-space">            </span>},</p>
<p class="p1"><span class="Apple-converted-space">            </span>ijzige_reus_gevecht: {</p>
<p class="p1"><span class="Apple-converted-space">                </span>text: (p) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>let friendsInFight = [];</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (p.chosenNpcRole !== "Lars" &amp;&amp; p.friendsMet.includes("Lars")) friendsInFight.push("Lars");</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (p.chosenNpcRole !== "Anouk" &amp;&amp; p.friendsMet.includes("Anouk")) friendsInFight.push("Anouk");</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                    </span>let text = `De ijzige reus is langzaam maar krachtig! Zijn vuisten zijn als rotsblokken. Samen met ${friendsInFight.join(' en ')} vechten jullie. Je verliest 25 gezondheid, maar de reus valt! Je pakt de tweede kristalscherf.`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (friendsInFight.length === 0) {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>text = `De ijzige reus is langzaam maar krachtig! Zijn vuisten zijn als rotsblokken. Je vecht alleen, maar met al je moed versla je hem! Je verliest 25 gezondheid en pakt de tweede kristalscherf.`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>}</p>
<p class="p1"><span class="Apple-converted-space">                    </span>return getAdjustedStoryText(text, 'ijzige_reus_gevecht');</p>
<p class="p1"><span class="Apple-converted-space">                </span>},</p>
<p class="p1"><span class="Apple-converted-space">                </span>effect: () =&gt; { player.health -= 25; player.crystalShards += 1; player.reputation += 15; },</p>
<p class="p1"><span class="Apple-converted-space">                </span>choices: [</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Tijd voor de laatste scherf!", nextState: "zoek_derde_scherf" }</p>
<p class="p1"><span class="Apple-converted-space">                </span>]</p>
<p class="p1"><span class="Apple-converted-space">            </span>},</p>
<p class="p1"><span class="Apple-converted-space">            </span>zoek_derde_scherf: {</p>
<p class="p1"><span class="Apple-converted-space">                </span>text: (p) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>let text = `Twee scherven zijn binnen! Terug in het hoofdkwartier vertelt Elizabeth, de kalme en verzamelde wachter, dat de laatste scherf in de Vuurlanden ligt, bewaakt door een oude vuurdraak. Pleun en Merijn zijn daar al op verkenning. Ze hebben een plan om de draak te omzeilen.`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (p.chosenNpcRole === "Elizabeth") {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>text = `Twee scherven zijn binnen! Terug in het hoofdkwartier vertel jij, de kalme en verzamelde wachter, dat de laatste scherf in de Vuurlanden ligt, bewaakt door een oude vuurdraak. Pleun en Merijn zijn daar al op verkenning. Ze hebben een plan om de draak te omzeilen.`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>}</p>
<p class="p1"><span class="Apple-converted-space">                    </span>return getAdjustedStoryText(text, 'zoek_derde_scherf');</p>
<p class="p1"><span class="Apple-converted-space">                </span>},</p>
<p class="p1"><span class="Apple-converted-space">                </span>effect: () =&gt; { if (player.chosenNpcRole !== "Elizabeth" &amp;&amp; !player.friendsMet.includes("Elizabeth")) player.friendsMet.push("Elizabeth"); },</p>
<p class="p1"><span class="Apple-converted-space">                </span>choices: [</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Reis naar de Vuurlanden.", nextState: "vuurlanden_aankomst" }</p>
<p class="p1"><span class="Apple-converted-space">                </span>]</p>
<p class="p1"><span class="Apple-converted-space">            </span>},</p>
<p class="p1"><span class="Apple-converted-space">            </span>vuurlanden_aankomst: {</p>
<p class="p1"><span class="Apple-converted-space">                </span>text: (p) =&gt; getAdjustedStoryText("De hitte van de Vuurlanden slaat je tegemoet. De grond is gebarsten en lava stroomt in de verte. Je ziet rookpluimen opstijgen van een actieve vulkaan, en in de verte een oude, verlaten observatiepost. Wat doe je?", 'vuurlanden_aankomst'),</p>
<p class="p1"><span class="Apple-converted-space">                </span>choices: [</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Volg de rookpluimen naar de vulkaan.", nextState: "volg_rook" },</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Onderzoek de verlaten observatiepost.", nextState: "observatiepost" }</p>
<p class="p1"><span class="Apple-converted-space">                </span>]</p>
<p class="p1"><span class="Apple-converted-space">            </span>},</p>
<p class="p1"><span class="Apple-converted-space">            </span>volg_rook: {</p>
<p class="p1"><span class="Apple-converted-space">                </span>text: (p) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>let text = `De rook leidt je naar een actieve vulkaan. Je ziet Pleun en Merijn bij de kraterrand, bezig met een vreemd, complex apparaat. Ze zwaaien enthousiast. Je verliest 10 gezondheid door de intense hitte.`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (p.chosenNpcRole === "Pleun") {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>text = `De rook leidt je naar een actieve vulkaan. Jij en Merijn zijn bij de kraterrand, bezig met een vreemd, complex apparaat. Jullie zwaaien enthousiast. Je verliest 10 gezondheid door de intense hitte.`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>} else if (p.chosenNpcRole === "Merijn") {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>text = `De rook leidt je naar een actieve vulkaan. Je ziet Pleun en jou bij de kraterrand, bezig met een vreemd, complex apparaat. Jullie zwaaien enthousiast. Je verliest 10 gezondheid door de intense hitte.`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>}</p>
<p class="p1"><span class="Apple-converted-space">                    </span>return getAdjustedStoryText(text, 'volg_rook');</p>
<p class="p1"><span class="Apple-converted-space">                </span>},</p>
<p class="p1"><span class="Apple-converted-space">                </span>effect: () =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>player.health -= 10;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (player.chosenNpcRole !== "Pleun" &amp;&amp; !player.friendsMet.includes("Pleun")) player.friendsMet.push("Pleun");</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (player.chosenNpcRole !== "Merijn" &amp;&amp; !player.friendsMet.includes("Merijn")) player.friendsMet.push("Merijn");</p>
<p class="p1"><span class="Apple-converted-space">                </span>},</p>
<p class="p1"><span class="Apple-converted-space">                </span>choices: [</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Vraag wat ze aan het doen zijn.", nextState: "pleun_merijn_apparaat" }</p>
<p class="p1"><span class="Apple-converted-space">                </span>]</p>
<p class="p1"><span class="Apple-converted-space">            </span>},</p>
<p class="p1"><span class="Apple-converted-space">            </span>observatiepost: {</p>
<p class="p1"><span class="Apple-converted-space">                </span>text: (p) =&gt; getAdjustedStoryText("De observatiepost is stoffig en verlaten, maar de instrumenten zijn nog intact. Je vindt een logboek dat spreekt over 'seismische verstoringen' en 'een zwakke plek in de drakenhuid, blootgesteld door extreme hitte'. Je reputatie stijgt door je onderzoek.", 'observatiepost'),</p>
<p class="p1"><span class="Apple-converted-space">                </span>effect: () =&gt; { player.reputation += 10; player.learnedAboutDragonWeakness = true; },</p>
<p class="p1"><span class="Apple-converted-space">                </span>choices: [</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Ga verder richting de vulkaan.", nextState: "volg_rook" }</p>
<p class="p1"><span class="Apple-converted-space">                </span>]</p>
<p class="p1"><span class="Apple-converted-space">            </span>},</p>
<p class="p1"><span class="Apple-converted-space">            </span>pleun_merijn_apparaat: {</p>
<p class="p1"><span class="Apple-converted-space">                </span>text: (p) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>let text = `Pleun legt uit: 'Dit is een seismische stabilisator. Merijn heeft hem gebouwd om de vulkaan te kalmeren, zodat we veilig bij het drakenhol kunnen komen. De derde scherf is daar!' Merijn voegt toe: 'Het apparaat heeft alleen nog wat zeldzame mineralen nodig die diep in de vulkaan te vinden zijn.'`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (p.chosenNpcRole === "Pleun") {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>text = `Jij legt uit: 'Dit is een seismische stabilisator. Merijn heeft hem gebouwd om de vulkaan te kalmeren, zodat we veilig bij het drakenhol kunnen komen. De derde scherf is daar!' Merijn voegt toe: 'Het apparaat heeft alleen nog wat zeldzame mineralen nodig die diep in de vulkaan te vinden zijn.'`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>} else if (p.chosenNpcRole === "Merijn") {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>text = `Pleun legt uit: 'Dit is een seismische stabilisator. Jij hebt hem gebouwd om de vulkaan te kalmeren, zodat we veilig bij het drakenhol kunnen komen. De derde scherf is daar!' Jij voegt toe: 'Het apparaat heeft alleen nog wat zeldzame mineralen nodig die diep in de vulkaan te vinden zijn.'`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>}</p>
<p class="p1"><span class="Apple-converted-space">                    </span>return getAdjustedStoryText(text, 'pleun_merijn_apparaat');</p>
<p class="p1"><span class="Apple-converted-space">                </span>},</p>
<p class="p1"><span class="Apple-converted-space">                </span>choices: [</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Help ze de mineralen te vinden.", nextState: "vind_mineralen" },</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Ga zelf naar het drakenhol (als je de kaart of info hebt).", nextState: "drakenhol_kaart_of_info" }</p>
<p class="p1"><span class="Apple-converted-space">                </span>]</p>
<p class="p1"><span class="Apple-converted-space">            </span>},</p>
<p class="p1"><span class="Apple-converted-space">            </span>vind_mineralen: {</p>
<p class="p1"><span class="Apple-converted-space">                </span>text: (p) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>let text = `Samen met Pleun en Merijn daal je af in de vulkaan. Het is gevaarlijk, maar Merijn's inventiviteit en Pleun's middelen helpen jullie. Je verliest 15 gezondheid, maar vindt de mineralen. Je reputatie stijgt door jullie teamwerk.`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (p.chosenNpcRole === "Pleun") {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>text = `Samen met Merijn daal je af in de vulkaan. Het is gevaarlijk, maar Merijn's inventiviteit en jouw middelen helpen jullie. Je verliest 15 gezondheid, maar vindt de mineralen. Je reputatie stijgt door jullie teamwerk.`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>} else if (p.chosenNpcRole === "Merijn") {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>text = `Samen met Pleun daal je af in de vulkaan. Het is gevaarlijk, maar jouw inventiviteit en Pleun's middelen helpen jullie. Je verliest 15 gezondheid, maar vindt de mineralen. Je reputatie stijgt door jullie teamwerk.`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>}</p>
<p class="p1"><span class="Apple-converted-space">                    </span>return getAdjustedStoryText(text, 'vind_mineralen');</p>
<p class="p1"><span class="Apple-converted-space">                </span>},</p>
<p class="p1"><span class="Apple-converted-space">                </span>effect: () =&gt; { player.health -= 15; player.reputation += 15; },</p>
<p class="p1"><span class="Apple-converted-space">                </span>choices: [</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Activeer de stabilisator.", nextState: "activeer_stabilisator" }</p>
<p class="p1"><span class="Apple-converted-space">                </span>]</p>
<p class="p1"><span class="Apple-converted-space">            </span>},</p>
<p class="p1"><span class="Apple-converted-space">            </span>activeer_stabilisator: {</p>
<p class="p1"><span class="Apple-converted-space">                </span>text: (p) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>let text = `De seismische stabilisator wordt geactiveerd! De vulkaan kalmeert en de weg naar het drakenhol is veilig. Jullie gaan samen verder. 'Dat was kicken!' roept Pleun.`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (p.chosenNpcRole === "Pleun") {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>text = `De seismische stabilisator wordt geactiveerd! De vulkaan kalmeert en de weg naar het drakenhol is veilig. Jullie gaan samen verder. 'Dat was kicken!' roep jij.`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>}</p>
<p class="p1"><span class="Apple-converted-space">                    </span>return getAdjustedStoryText(text, 'activeer_stabilisator');</p>
<p class="p1"><span class="Apple-converted-space">                </span>},</p>
<p class="p1"><span class="Apple-converted-space">                </span>choices: [</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Ga naar het drakenhol.", nextState: "drakenhol_ingang" }</p>
<p class="p1"><span class="Apple-converted-space">                </span>]</p>
<p class="p1"><span class="Apple-converted-space">            </span>},</p>
<p class="p1"><span class="Apple-converted-space">            </span>drakenhol_kaart_of_info: {</p>
<p class="p1"><span class="Apple-converted-space">                </span>text: (p) =&gt; getAdjustedStoryText("Je besluit alleen verder te gaan, gewapend met de kennis die je hebt opgedaan (of de kaart, als je die hebt). Je vindt de ingang van het drakenhol. Een diep, hees gegrom klinkt van binnenuit. Wat doe je?", 'drakenhol_kaart_of_info'),</p>
<p class="p1"><span class="Apple-converted-space">                </span>choices: [</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Ga het drakenhol in.", nextState: "drakenhol_ingang" }</p>
<p class="p1"><span class="Apple-converted-space">                </span>]</p>
<p class="p1"><span class="Apple-converted-space">            </span>},</p>
<p class="p1"><span class="Apple-converted-space">            </span>drakenhol_ingang: {</p>
<p class="p1"><span class="Apple-converted-space">                </span>text: (p) =&gt; getAdjustedStoryText("Binnenin het drakenhol is het een broeierige hitte. In het midden van een lavameer ligt de laatste kristalscherf, bewaakt door een eeuwenoude, vuurspuwende draak! Zijn ogen gloeien als sintels. Wat doe je?", 'drakenhol_ingang'),</p>
<p class="p1"><span class="Apple-converted-space">                </span>choices: [</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Vecht tegen de draak!", nextState: "draak_gevecht_eind" },</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Probeer zijn zwakke plek te benutten (als je die hebt ontdekt).", nextState: "draak_zwakke_plek" }</p>
<p class="p1"><span class="Apple-converted-space">                </span>]</p>
<p class="p1"><span class="Apple-converted-space">            </span>},</p>
<p class="p1"><span class="Apple-converted-space">            </span>draak_zwakke_plek: {</p>
<p class="p1"><span class="Apple-converted-space">                </span>text: (p) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>let text = `Je herinnert je de informatie over de zwakke plek van de draak. Je richt je aanval op die ene plek. De draak brult van pijn! Het gevecht is zwaar, maar minder dodelijk. Je verliest 20 gezondheid. De draak is verslagen! Je bemachtigt de laatste kristalscherf.`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (p.learnedAboutDragonWeakness) {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>text = `Je herinnert je de informatie over de zwakke plek van de draak. Je richt je aanval op die ene plek. De draak brult van pijn! Het gevecht is zwaar, maar minder dodelijk. Je verliest 20 gezondheid. De draak is verslagen! Je bemachtigt de laatste kristalscherf.`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>text = `Je probeert een zwakke plek te vinden, maar de draak is te snel. Je verliest 30 gezondheid en moet direct vechten!`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>}</p>
<p class="p1"><span class="Apple-converted-space">                    </span>return getAdjustedStoryText(text, 'draak_zwakke_plek');</p>
<p class="p1"><span class="Apple-converted-space">                </span>},</p>
<p class="p1"><span class="Apple-converted-space">                </span>effect: () =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (player.learnedAboutDragonWeakness) {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>player.health -= 20;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>player.crystalShards += 1;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>player.reputation += 30; // Extra reputatie voor slimheid</p>
<p class="p1"><span class="Apple-converted-space">                        </span>updateGame('alle_scherven_gevonden');</p>
<p class="p1"><span class="Apple-converted-space">                    </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>player.health -= 30; // Minder effectief zonder kennis</p>
<p class="p1"><span class="Apple-converted-space">                        </span>updateGame('draak_gevecht_eind');</p>
<p class="p1"><span class="Apple-converted-space">                    </span>}</p>
<p class="p1"><span class="Apple-converted-space">                </span>},</p>
<p class="p1"><span class="Apple-converted-space">                </span>choices: [</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Ga verder.", nextState: "continue_after_dragon_weakness" }</p>
<p class="p1"><span class="Apple-converted-space">                </span>]</p>
<p class="p1"><span class="Apple-converted-space">            </span>},</p>
<p class="p1"><span class="Apple-converted-space">            </span>continue_after_dragon_weakness: {</p>
<p class="p1"><span class="Apple-converted-space">                </span>text: (p) =&gt; getAdjustedStoryText("...", 'continue_after_dragon_weakness'), // Placeholder</p>
<p class="p1"><span class="Apple-converted-space">                </span>choices: [] // Placeholder</p>
<p class="p1"><span class="Apple-converted-space">            </span>},</p>
<p class="p1"><span class="Apple-converted-space">            </span>draak_gevecht_eind: {</p>
<p class="p1"><span class="Apple-converted-space">                </span>text: (p) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>let friendsInFight = [];</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (p.chosenNpcRole !== "Pleun" &amp;&amp; p.friendsMet.includes("Pleun")) friendsInFight.push("Pleun");</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (p.chosenNpcRole !== "Merijn" &amp;&amp; p.friendsMet.includes("Merijn")) friendsInFight.push("Merijn");</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                    </span>let text = `De vuurdraak is een machtige tegenstander! (Je gezondheid: ${p.health}). Samen met ${friendsInFight.join(' en ')} vechten jullie, wat het gevecht aanzienlijk vergemakkelijkt. Je verliest 40 gezondheid, maar de draak is verslagen! Je bemachtigt de laatste kristalscherf.`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (friendsInFight.length === 0) {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>text = `De vuurdraak is een machtige tegenstander! (Je gezondheid: ${p.health}). Je vecht alleen, maar met al je moed versla je hem! Je verliest 40 gezondheid en bemachtigt de laatste kristalscherf.`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>}</p>
<p class="p1"><span class="Apple-converted-space">                    </span>return getAdjustedStoryText(text, 'draak_gevecht_eind');</p>
<p class="p1"><span class="Apple-converted-space">                </span>},</p>
<p class="p1"><span class="Apple-converted-space">                </span>effect: () =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>player.health -= 40;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>player.crystalShards += 1;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>player.reputation += 20;</p>
<p class="p1"><span class="Apple-converted-space">                </span>},</p>
<p class="p1"><span class="Apple-converted-space">                </span>choices: [</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Keer terug naar het hoofdkwartier.", nextState: "alle_scherven_gevonden" }</p>
<p class="p1"><span class="Apple-converted-space">                </span>]</p>
<p class="p1"><span class="Apple-converted-space">            </span>},</p>
<p class="p1"><span class="Apple-converted-space">            </span>alle_scherven_gevonden: {</p>
<p class="p1"><span class="Apple-converted-space">                </span>text: (p) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>let allFriends = npcCharacters.map(char =&gt; char.name).filter(name =&gt; name !== p.chosenNpcRole);</p>
<p class="p1"><span class="Apple-converted-space">                    </span>let friendsList = allFriends.join(', ');</p>
<p class="p1"><span class="Apple-converted-space">                    </span>let text = `Met alle drie de scherven in handen keer je terug naar het hoofdkwartier. Een golf van opluchting en hoop stroomt door de zaal. De hele groep van de Regenboogwachters - ${friendsList} - wacht op je. Hun gezichten stralen van trots. Het is tijd om het kristal te herstellen!`;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>return getAdjustedStoryText(text, 'alle_scherven_gevonden');</p>
<p class="p1"><span class="Apple-converted-space">                </span>},</p>
<p class="p1"><span class="Apple-converted-space">                </span>choices: [</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Herstel het Regenboogkristal.", nextState: "kristal_herstellen" }</p>
<p class="p1"><span class="Apple-converted-space">                </span>]</p>
<p class="p1"><span class="Apple-converted-space">            </span>},</p>
<p class="p1"><span class="Apple-converted-space">            </span>kristal_herstellen: {</p>
<p class="p1"><span class="Apple-converted-space">                </span>text: (p) =&gt; getAdjustedStoryText("Jullie plaatsen de drie scherven op het altaar. Een regenboog van licht schiet omhoog en het kristal vormt zich weer tot één geheel! De kracht stroomt door jullie heen, de kleuren keren terug in de wereld. De duistere schaduw wijkt. De wereld is gered!", 'kristal_herstellen'),</p>
<p class="p1"><span class="Apple-converted-space">                </span>choices: [</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Einde.", nextState: "end_win" }</p>
<p class="p1"><span class="Apple-converted-space">                </span>]</p>
<p class="p1"><span class="Apple-converted-space">            </span>},</p>
<p class="p1"><span class="Apple-converted-space">            </span>end_win: {</p>
<p class="p1"><span class="Apple-converted-space">                </span>text: (p) =&gt; getAdjustedStoryText(`Gefeliciteerd, ${p.name}! Samen met de Regenboogwachters heb je het kristal hersteld en de wereld gered! Jouw naam zal voor altijd voortleven in de kronieken als een ware held van Rainbow Dash. De toekomst is weer kleurrijk!`, 'end_win'),</p>
<p class="p1"><span class="Apple-converted-space">                </span>isEnd: true,</p>
<p class="p1"><span class="Apple-converted-space">                </span>win: true</p>
<p class="p1"><span class="Apple-converted-space">            </span>},</p>
<p class="p1"><span class="Apple-converted-space">            </span>end_lose_health: {</p>
<p class="p1"><span class="Apple-converted-space">                </span>text: (p) =&gt; getAdjustedStoryText(`Je gezondheid is te laag. Je valt neer, overweldigd door je verwondingen. Jouw avontuur eindigt hier, ${p.name}. De Regenboogwachters zullen een andere held moeten vinden, hopend dat zij succesvoller zijn. De schaduw blijft hangen...`, 'end_lose_health'),</p>
<p class="p1"><span class="Apple-converted-space">                </span>isEnd: true,</p>
<p class="p1"><span class="Apple-converted-space">                </span>win: false</p>
<p class="p1"><span class="Apple-converted-space">            </span>},</p>
<p class="p1"><span class="Apple-converted-space">            </span>end_bewaker_te_sterk: {</p>
<p class="p1"><span class="Apple-converted-space">                </span>text: (p) =&gt; getAdjustedStoryText(`De bewaker was te sterk. Je bent verslagen. Jouw avontuur eindigt hier, ${p.name}. Zonder jou zal het kristal misschien nooit hersteld worden.`, 'end_bewaker_te_sterk'),</p>
<p class="p1"><span class="Apple-converted-space">                </span>isEnd: true,</p>
<p class="p1"><span class="Apple-converted-space">                </span>win: false</p>
<p class="p1"><span class="Apple-converted-space">            </span>},</p>
<p class="p1"><span class="Apple-converted-space">            </span>// Random Events</p>
<p class="p1"><span class="Apple-converted-space">            </span>random_event_1: {</p>
<p class="p1"><span class="Apple-converted-space">                </span>text: (p) =&gt; getAdjustedStoryText("Terwijl je verder reist, kom je een verdwaalde handelaar tegen. Hij biedt je een 'magisch' drankje aan voor 10 goud. Wat doe je?", 'random_event_1'),</p>
<p class="p1"><span class="Apple-converted-space">                </span>choices: [</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Koop het drankje (10 goud).", nextState: "random_event_1_koop" },</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Negeer hem en ga verder.", nextState: "random_event_continue" }</p>
<p class="p1"><span class="Apple-converted-space">                </span>]</p>
<p class="p1"><span class="Apple-converted-space">            </span>},</p>
<p class="p1"><span class="Apple-converted-space">            </span>random_event_1_koop: {</p>
<p class="p1"><span class="Apple-converted-space">                </span>text: (p) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (Math.random() &lt; 0.5) {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>player.health += 15;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>return getAdjustedStoryText("Het drankje smaakt vreemd, maar je voelt je direct beter! Je gezondheid stijgt met 15. De handelaar knipoogt en verdwijnt. (+15 Gezondheid)", 'random_event_1_koop');</p>
<p class="p1"><span class="Apple-converted-space">                    </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>player.health -= 5;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>return getAdjustedStoryText("Het drankje smaakt naar oude sokken en je voelt je een beetje misselijk. Je verliest 5 gezondheid. De handelaar lacht en verdwijnt. (-5 Gezondheid)", 'random_event_1_koop');</p>
<p class="p1"><span class="Apple-converted-space">                    </span>}</p>
<p class="p1"><span class="Apple-converted-space">                </span>},</p>
<p class="p1"><span class="Apple-converted-space">                </span>effect: () =&gt; { player.gold -= 10; },</p>
<p class="p1"><span class="Apple-converted-space">                </span>choices: [</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Ga verder met je reis.", nextState: "return_from_random_event" }</p>
<p class="p1"><span class="Apple-converted-space">                </span>]</p>
<p class="p1"><span class="Apple-converted-space">            </span>},</p>
<p class="p1"><span class="Apple-converted-space">            </span>random_event_2: {</p>
<p class="p1"><span class="Apple-converted-space">                </span>text: (p) =&gt; getAdjustedStoryText("Je stuit op een kleine, verlaten schatkist. Het slot is roestig. Wat doe je?", 'random_event_2'),</p>
<p class="p1"><span class="Apple-converted-space">                </span>choices: [</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Probeer het slot te forceren.", nextState: "random_event_2_forceer" },</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Laat de kist met rust.", nextState: "random_event_continue" }</p>
<p class="p1"><span class="Apple-converted-space">                </span>]</p>
<p class="p1"><span class="Apple-converted-space">            </span>},</p>
<p class="p1"><span class="Apple-converted-space">            </span>random_event_2_forceer: {</p>
<p class="p1"><span class="Apple-converted-space">                </span>text: (p) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (Math.random() &lt; 0.7) { // 70% kans op succes</p>
<p class="p1"><span class="Apple-converted-space">                        </span>player.gold += 30;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>return getAdjustedStoryText("Met een harde ruk forceer je het slot open! Binnenin vind je 30 goud! (+30 Goud)", 'random_event_2_forceer');</p>
<p class="p1"><span class="Apple-converted-space">                    </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>player.health -= 5;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>return getAdjustedStoryText("Het slot is sterker dan verwacht. Je bezeert je hand en verliest 5 gezondheid. De kist blijft gesloten. (-5 Gezondheid)", 'random_event_2_forceer');</p>
<p class="p1"><span class="Apple-converted-space">                    </span>}</p>
<p class="p1"><span class="Apple-converted-space">                </span>},</p>
<p class="p1"><span class="Apple-converted-space">                </span>choices: [</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Ga verder met je reis.", nextState: "return_from_random_event" }</p>
<p class="p1"><span class="Apple-converted-space">                </span>]</p>
<p class="p1"><span class="Apple-converted-space">            </span>},</p>
<p class="p1"><span class="Apple-converted-space">            </span>random_event_continue: {</p>
<p class="p1"><span class="Apple-converted-space">                </span>text: (p) =&gt; getAdjustedStoryText("Je besluit geen risico te nemen en vervolgt je weg. Het avontuur wacht!", 'random_event_continue'),</p>
<p class="p1"><span class="Apple-converted-space">                </span>choices: [</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ text: "Ga verder met je reis.", nextState: "return_from_random_event" }</p>
<p class="p1"><span class="Apple-converted-space">                </span>]</p>
<p class="p1"><span class="Apple-converted-space">            </span>},</p>
<p class="p1"><span class="Apple-converted-space">            </span>return_from_random_event: {</p>
<p class="p1"><span class="Apple-converted-space">                </span>text: (p) =&gt; getAdjustedStoryText("Je bent weer op het juiste pad. Het avontuur gaat verder.", 'return_from_random_event'),</p>
<p class="p1"><span class="Apple-converted-space">                </span>choices: [] // Dit wordt dynamisch ingevuld</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>};</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>let currentGameState = "intro";</p>
<p class="p1"><span class="Apple-converted-space">        </span>let previousMainGameState = null; // Om terug te keren na een random event</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Functie om de game state te updaten en weer te geven</p>
<p class="p1"><span class="Apple-converted-space">        </span>function updateGame(stateKey) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>// Controleer op game over door gezondheid VOORDAT de nieuwe state wordt verwerkt</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (player.health &lt;= 0) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>endGame("end_lose_health");</p>
<p class="p1"><span class="Apple-converted-space">                </span>return;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>const state = gameStates[stateKey];</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (!state) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>console.error("Onbekende speltoestand:", stateKey);</p>
<p class="p1"><span class="Apple-converted-space">                </span>return;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Pas effecten toe als die er zijn</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (state.effect) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>state.effect();</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Update UI met nieuwe stats</p>
<p class="p1"><span class="Apple-converted-space">            </span>playerNameDisplay.textContent = player.name;</p>
<p class="p1"><span class="Apple-converted-space">            </span>playerHealthDisplay.textContent = player.health;</p>
<p class="p1"><span class="Apple-converted-space">            </span>playerGoldDisplay.textContent = player.gold;</p>
<p class="p1"><span class="Apple-converted-space">            </span>playerShardsDisplay.textContent = player.crystalShards;</p>
<p class="p1"><span class="Apple-converted-space">            </span>playerReputationDisplay.textContent = player.reputation;</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Controleer opnieuw op game over na effecten (als een effect gezondheid verlaagt)</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (player.health &lt;= 0) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>endGame("end_lose_health");</p>
<p class="p1"><span class="Apple-converted-space">                </span>return;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Toon de tekst en keuzes</p>
<p class="p1"><span class="Apple-converted-space">            </span>// Gebruik de getAdjustedStoryText helper voor dynamische tekst</p>
<p class="p1"><span class="Apple-converted-space">            </span>storyTextElement.textContent = typeof state.text === 'function' ? state.text(player) : getAdjustedStoryText(state.text, stateKey);</p>
<p class="p1"><span class="Apple-converted-space">            </span>choicesElement.innerHTML = ''; // Maak keuzes leeg</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>if (state.isEnd) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>endGame(stateKey);</p>
<p class="p1"><span class="Apple-converted-space">                </span>return;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Speciale logica voor random events</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (stateKey.startsWith("random_event_") &amp;&amp; stateKey !== "return_from_random_event") {</p>
<p class="p1"><span class="Apple-converted-space">                </span>// Als het een random event is, zorg dat de keuzes terugleiden naar de return state</p>
<p class="p1"><span class="Apple-converted-space">                </span>state.choices.forEach(choice =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>const button = document.createElement('button');</p>
<p class="p1"><span class="Apple-converted-space">                    </span>button.classList.add('choice-button');</p>
<p class="p1"><span class="Apple-converted-space">                    </span>button.textContent = choice.text;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>button.addEventListener('click', () =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>updateGame(choice.nextState);</p>
<p class="p1"><span class="Apple-converted-space">                    </span>});</p>
<p class="p1"><span class="Apple-converted-space">                    </span>choicesElement.appendChild(button);</p>
<p class="p1"><span class="Apple-converted-space">                </span>});</p>
<p class="p1"><span class="Apple-converted-space">            </span>} else if (stateKey === "return_from_random_event") {</p>
<p class="p1"><span class="Apple-converted-space">                </span>// Na een random event, keer terug naar de vorige hoofdstaat</p>
<p class="p1"><span class="Apple-converted-space">                </span>const button = document.createElement('button');</p>
<p class="p1"><span class="Apple-converted-space">                </span>button.classList.add('choice-button');</p>
<p class="p1"><span class="Apple-converted-space">                </span>button.textContent = "Ga verder met je avontuur.";</p>
<p class="p1"><span class="Apple-converted-space">                </span>button.addEventListener('click', () =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>updateGame(previousMainGameState);</p>
<p class="p1"><span class="Apple-converted-space">                </span>});</p>
<p class="p1"><span class="Apple-converted-space">                </span>choicesElement.appendChild(button);</p>
<p class="p1"><span class="Apple-converted-space">            </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                </span>// Normale speltoestanden</p>
<p class="p1"><span class="Apple-converted-space">                </span>state.choices.forEach(choice =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>const button = document.createElement('button');</p>
<p class="p1"><span class="Apple-converted-space">                    </span>button.classList.add('choice-button');</p>
<p class="p1"><span class="Apple-converted-space">                    </span>button.textContent = choice.text;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>button.addEventListener('click', () =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>// Sla de huidige hoofdstaat op voordat we naar een random event gaan</p>
<p class="p1"><span class="Apple-converted-space">                        </span>if (Math.random() &lt; 0.2 &amp;&amp; choice.nextState !== "end_win" &amp;&amp; choice.nextState !== "end_lose_health" &amp;&amp; choice.nextState !== "end_bewaker_te_sterk") { // 20% kans op random event</p>
<p class="p1"><span class="Apple-converted-space">                            </span>previousMainGameState = choice.nextState;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>const randomEventKeys = ["random_event_1", "random_event_2"];</p>
<p class="p1"><span class="Apple-converted-space">                            </span>const randomEvent = randomEventKeys[Math.floor(Math.random() * randomEventKeys.length)];</p>
<p class="p1"><span class="Apple-converted-space">                            </span>updateGame(randomEvent);</p>
<p class="p1"><span class="Apple-converted-space">                        </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                            </span>updateGame(choice.nextState);</p>
<p class="p1"><span class="Apple-converted-space">                        </span>}</p>
<p class="p1"><span class="Apple-converted-space">                    </span>});</p>
<p class="p1"><span class="Apple-converted-space">                    </span>choicesElement.appendChild(button);</p>
<p class="p1"><span class="Apple-converted-space">                </span>});</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>currentGameState = stateKey; // Update de huidige staat</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Functie om de speeltijd te formatteren</p>
<p class="p1"><span class="Apple-converted-space">        </span>function formatTime(milliseconds) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const totalSeconds = Math.floor(milliseconds / 1000);</p>
<p class="p1"><span class="Apple-converted-space">            </span>const minutes = Math.floor(totalSeconds / 60);</p>
<p class="p1"><span class="Apple-converted-space">            </span>const seconds = totalSeconds % 60;</p>
<p class="p1"><span class="Apple-converted-space">            </span>return `${minutes}m ${seconds}s`;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Functie om high scores op te slaan</p>
<p class="p1"><span class="Apple-converted-space">        </span>async function saveHighScore(name, score, duration) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (!isFirebaseReady) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>console.error("Firebase is niet klaar om scores op te slaan.");</p>
<p class="p1"><span class="Apple-converted-space">                </span>return;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">            </span>try {</p>
<p class="p1"><span class="Apple-converted-space">                </span>const scoresCollectionRef = collection(db, `artifacts/${appId}/public/data/rpg_highscores`);</p>
<p class="p1"><span class="Apple-converted-space">                </span>await addDoc(scoresCollectionRef, {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>name: name,</p>
<p class="p1"><span class="Apple-converted-space">                    </span>score: score,</p>
<p class="p1"><span class="Apple-converted-space">                    </span>duration: duration, // Sla duur op</p>
<p class="p1"><span class="Apple-converted-space">                    </span>timestamp: Date.now(),</p>
<p class="p1"><span class="Apple-converted-space">                    </span>userId: userId</p>
<p class="p1"><span class="Apple-converted-space">                </span>});</p>
<p class="p1"><span class="Apple-converted-space">                </span>console.log("Score opgeslagen!");</p>
<p class="p1"><span class="Apple-converted-space">            </span>} catch (e) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>console.error("Fout bij het opslaan van score: ", e);</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Functie om high scores te laden en weer te geven</p>
<p class="p1"><span class="Apple-converted-space">        </span>async function loadHighScores() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (!isFirebaseReady) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>console.error("Firebase is niet klaar om scores te laden.");</p>
<p class="p1"><span class="Apple-converted-space">                </span>highScoreList.innerHTML = '&lt;li&gt;Kan high scores niet laden.&lt;/li&gt;';</p>
<p class="p1"><span class="Apple-converted-space">                </span>return;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">            </span>try {</p>
<p class="p1"><span class="Apple-converted-space">                </span>const scoresCollectionRef = collection(db, `artifacts/${appId}/public/data/rpg_highscores`);</p>
<p class="p1"><span class="Apple-converted-space">                </span>onSnapshot(scoresCollectionRef, (snapshot) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>const scores = [];</p>
<p class="p1"><span class="Apple-converted-space">                    </span>snapshot.forEach((doc) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>scores.push(doc.data());</p>
<p class="p1"><span class="Apple-converted-space">                    </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                    </span>// Sorteer scores: eerst op score (hoogste), dan op duur (laagste)</p>
<p class="p1"><span class="Apple-converted-space">                    </span>scores.sort((a, b) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>if (b.score !== a.score) {</p>
<p class="p1"><span class="Apple-converted-space">                            </span>return b.score - a.score; // Hogere score eerst</p>
<p class="p1"><span class="Apple-converted-space">                        </span>}</p>
<p class="p1"><span class="Apple-converted-space">                        </span>return a.duration - b.duration; // Snellere tijd eerst bij gelijke score</p>
<p class="p1"><span class="Apple-converted-space">                    </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                    </span>highScoreList.innerHTML = '';</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (scores.length === 0) {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>highScoreList.innerHTML = '&lt;li&gt;Nog geen high scores!&lt;/li&gt;';</p>
<p class="p1"><span class="Apple-converted-space">                    </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>scores.slice(0, 10).forEach((s, index) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                            </span>const li = document.createElement('li');</p>
<p class="p1"><span class="Apple-converted-space">                            </span>li.innerHTML = `&lt;span&gt;${index + 1}. ${s.name || 'Anoniem'}&lt;/span&gt; &lt;span class="score-details"&gt;&lt;span&gt;Score: ${s.score}&lt;/span&gt; &lt;span&gt;Tijd: ${formatTime(s.duration)}&lt;/span&gt;&lt;/span&gt;`;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>highScoreList.appendChild(li);</p>
<p class="p1"><span class="Apple-converted-space">                        </span>});</p>
<p class="p1"><span class="Apple-converted-space">                    </span>}</p>
<p class="p1"><span class="Apple-converted-space">                </span>}, (error) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>console.error("Fout bij het luisteren naar high scores:", error);</p>
<p class="p1"><span class="Apple-converted-space">                    </span>highScoreList.innerHTML = '&lt;li&gt;Fout bij het laden van high scores.&lt;/li&gt;';</p>
<p class="p1"><span class="Apple-converted-space">                </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>} catch (e) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>console.error("Fout bij het laden van high scores: ", e);</p>
<p class="p1"><span class="Apple-converted-space">                </span>highScoreList.innerHTML = '&lt;li&gt;Fout bij het laden van high scores.&lt;/li&gt;';</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Start Game - Nu leidt dit naar de karakterselectie</p>
<p class="p1"><span class="Apple-converted-space">        </span>startGameButton.addEventListener('click', () =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">            </span>startScreen.classList.add('hidden');</p>
<p class="p1"><span class="Apple-converted-space">            </span>characterSelectionRpgScreen.classList.remove('hidden');</p>
<p class="p1"><span class="Apple-converted-space">            </span>renderCharacterCards(); // Render de kaarten</p>
<p class="p1"><span class="Apple-converted-space">        </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Select Character Button</p>
<p class="p1"><span class="Apple-converted-space">        </span>selectCharacterRpgButton.addEventListener('click', () =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (selectedCharacterName) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>player.name = selectedCharacterName;</p>
<p class="p1"><span class="Apple-converted-space">                </span>player.chosenNpcRole = selectedCharacterName; // Sla de gekozen NPC rol op</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>// Verwijder de gekozen NPC uit de 'friendsMet' lijst als die er al in zou staan</p>
<p class="p1"><span class="Apple-converted-space">                </span>// Dit zorgt ervoor dat de speler zichzelf niet ontmoet</p>
<p class="p1"><span class="Apple-converted-space">                </span>player.friendsMet = player.friendsMet.filter(friend =&gt; friend !== selectedCharacterName);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>characterSelectionRpgScreen.classList.add('hidden');</p>
<p class="p1"><span class="Apple-converted-space">                </span>// Reset speler stats voor een nieuw spel</p>
<p class="p1"><span class="Apple-converted-space">                </span>player.health = 100;</p>
<p class="p1"><span class="Apple-converted-space">                </span>player.gold = 0;</p>
<p class="p1"><span class="Apple-converted-space">                </span>player.crystalShards = 0;</p>
<p class="p1"><span class="Apple-converted-space">                </span>player.reputation = 0;</p>
<p class="p1"><span class="Apple-converted-space">                </span>player.inventory = [];</p>
<p class="p1"><span class="Apple-converted-space">                </span>player.friendsMet = []; // Zorg ervoor dat deze leeg is bij start</p>
<p class="p1"><span class="Apple-converted-space">                </span>player.startTime = Date.now(); // Start de timer</p>
<p class="p1"><span class="Apple-converted-space">                </span>player.endTime = 0;</p>
<p class="p1"><span class="Apple-converted-space">                </span>player.duration = 0;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>updateGame('intro'); // Start het spel</p>
<p class="p1"><span class="Apple-converted-space">            </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                </span>console.log("Kies alstublieft een personage om te beginnen!");</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>});</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Overige Event Listeners</p>
<p class="p1"><span class="Apple-converted-space">        </span>showHighscoresButton.addEventListener('click', () =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">            </span>startScreen.classList.add('hidden');</p>
<p class="p1"><span class="Apple-converted-space">            </span>highScoreScreen.classList.remove('hidden');</p>
<p class="p1"><span class="Apple-converted-space">            </span>loadHighScores(); // Laad scores wanneer het scherm wordt geopend</p>
<p class="p1"><span class="Apple-converted-space">        </span>});</p>
<p class="p1"><span class="Apple-converted-space">        </span>restartGameButton.addEventListener('click', () =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">            </span>endScreen.classList.add('hidden');</p>
<p class="p1"><span class="Apple-converted-space">            </span>startScreen.classList.remove('hidden'); // Terug naar startscherm</p>
<p class="p1"><span class="Apple-converted-space">            </span>selectedCharacterName = null; // Reset selectie</p>
<p class="p1"><span class="Apple-converted-space">            </span>selectCharacterRpgButton.disabled = true; // Disable knop</p>
<p class="p1"><span class="Apple-converted-space">        </span>});</p>
<p class="p1"><span class="Apple-converted-space">        </span>backToMenuFromHighscoresButton.addEventListener('click', () =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">            </span>highScoreScreen.classList.add('hidden');</p>
<p class="p1"><span class="Apple-converted-space">            </span>startScreen.classList.remove('hidden'); // Terug naar startscherm</p>
<p class="p1"><span class="Apple-converted-space">        </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/script&gt;</p>
<p class="p1">&lt;/body&gt;</p>
<p class="p1">&lt;/html&gt;</p>
</body>
</html>
